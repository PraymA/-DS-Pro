<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>4123643db9c04ea7902ed5fe5cf4f59f</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell code" data-execution_count="201" id="iTHup_cW_nrn">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> metrics</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.compose <span class="im">import</span> ColumnTransformer</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OrdinalEncoder, StandardScaler</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split, GridSearchCV, KFold, cross_val_score, cross_validate</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVR</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.dummy <span class="im">import</span> DummyRegressor</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, r2_score, mean_absolute_percentage_error, mean_absolute_error</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression, Ridge, Lasso</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsRegressor</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestRegressor, GradientBoostingRegressor</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeRegressor</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neural_network <span class="im">import</span> MLPRegressor</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow <span class="im">import</span> keras</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras <span class="im">import</span> layers</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Dense, Flatten, Dropout, BatchNormalization, Activation</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="q2pyd8Lg_jgt" data-outputId="71520e85-c547-4647-ff92-f603d27ba3a2">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_excel(<span class="st">&#39;/content/drive/MyDrive/DatasetsVKR/df_norm.xlsx&#39;</span>).drop([<span class="st">&#39;Unnamed: 0&#39;</span>], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.shape)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(922, 13)
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 922 entries, 0 to 921
Data columns (total 13 columns):
 #   Column                                Non-Null Count  Dtype  
---  ------                                --------------  -----  
 0   Соотношение матрица-наполнитель       922 non-null    float64
 1   Плотность, кг/м3                      922 non-null    float64
 2   Модуль упругости, ГПа                 922 non-null    float64
 3   Количество отвердителя, м.%           922 non-null    float64
 4   Содержание эпоксидных групп,%_2       922 non-null    float64
 5   Температура вспышки, С_2              922 non-null    float64
 6   Поверхностная плотность, г/м2         922 non-null    float64
 7   Модуль упругости при растяжении, ГПа  922 non-null    float64
 8   Прочность при растяжении, МПа         922 non-null    float64
 9   Потребление смолы, г/м2               922 non-null    float64
 10  Угол нашивки                          922 non-null    int64  
 11  Шаг нашивки                           922 non-null    float64
 12  Плотность нашивки                     922 non-null    float64
dtypes: float64(12), int64(1)
memory usage: 93.8 KB
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:458}"
id="P7cByAZOb3EE" data-outputId="ed1a3b85-eda2-471f-8194-070be9a69af0">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># в соответствии с заданием ВКР необходимо обучить модели для прогноза параметров модуля упругости при растяжении и прочности при растяжении</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="output execute_result" data-execution_count="121">

  <div id="df-995e9e65-5780-42d7-a8a9-33cc29a7dd94" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Соотношение матрица-наполнитель</th>
      <th>Плотность, кг/м3</th>
      <th>Модуль упругости, ГПа</th>
      <th>Количество отвердителя, м.%</th>
      <th>Содержание эпоксидных групп,%_2</th>
      <th>Температура вспышки, С_2</th>
      <th>Поверхностная плотность, г/м2</th>
      <th>Модуль упругости при растяжении, ГПа</th>
      <th>Прочность при растяжении, МПа</th>
      <th>Потребление смолы, г/м2</th>
      <th>Угол нашивки</th>
      <th>Шаг нашивки</th>
      <th>Плотность нашивки</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.857143</td>
      <td>2030.000000</td>
      <td>738.736842</td>
      <td>50.000000</td>
      <td>23.750000</td>
      <td>284.615385</td>
      <td>210.000000</td>
      <td>70.000000</td>
      <td>3000.000000</td>
      <td>220.000000</td>
      <td>0</td>
      <td>4.000000</td>
      <td>60.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.857143</td>
      <td>2030.000000</td>
      <td>738.736842</td>
      <td>129.000000</td>
      <td>21.250000</td>
      <td>300.000000</td>
      <td>210.000000</td>
      <td>70.000000</td>
      <td>3000.000000</td>
      <td>220.000000</td>
      <td>0</td>
      <td>5.000000</td>
      <td>47.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.771331</td>
      <td>2030.000000</td>
      <td>753.000000</td>
      <td>111.860000</td>
      <td>22.267857</td>
      <td>284.615385</td>
      <td>210.000000</td>
      <td>70.000000</td>
      <td>3000.000000</td>
      <td>220.000000</td>
      <td>0</td>
      <td>5.000000</td>
      <td>57.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.767918</td>
      <td>2000.000000</td>
      <td>748.000000</td>
      <td>111.860000</td>
      <td>22.267857</td>
      <td>284.615385</td>
      <td>210.000000</td>
      <td>70.000000</td>
      <td>3000.000000</td>
      <td>220.000000</td>
      <td>0</td>
      <td>5.000000</td>
      <td>60.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.569620</td>
      <td>1910.000000</td>
      <td>807.000000</td>
      <td>111.860000</td>
      <td>22.267857</td>
      <td>284.615385</td>
      <td>210.000000</td>
      <td>70.000000</td>
      <td>3000.000000</td>
      <td>220.000000</td>
      <td>0</td>
      <td>5.000000</td>
      <td>70.000000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>917</th>
      <td>2.271346</td>
      <td>1952.087902</td>
      <td>912.855545</td>
      <td>86.992183</td>
      <td>20.123249</td>
      <td>324.774576</td>
      <td>209.198700</td>
      <td>73.090961</td>
      <td>2387.292495</td>
      <td>125.007669</td>
      <td>1</td>
      <td>9.076380</td>
      <td>47.019770</td>
    </tr>
    <tr>
      <th>918</th>
      <td>3.444022</td>
      <td>2050.089171</td>
      <td>444.732634</td>
      <td>145.981978</td>
      <td>19.599769</td>
      <td>254.215401</td>
      <td>350.660830</td>
      <td>72.920827</td>
      <td>2360.392784</td>
      <td>117.730099</td>
      <td>1</td>
      <td>10.565614</td>
      <td>53.750790</td>
    </tr>
    <tr>
      <th>919</th>
      <td>3.280604</td>
      <td>1972.372865</td>
      <td>416.836524</td>
      <td>110.533477</td>
      <td>23.957502</td>
      <td>248.423047</td>
      <td>740.142791</td>
      <td>74.734344</td>
      <td>2662.906040</td>
      <td>236.606764</td>
      <td>1</td>
      <td>4.161154</td>
      <td>67.629684</td>
    </tr>
    <tr>
      <th>920</th>
      <td>3.705351</td>
      <td>2066.799773</td>
      <td>741.475517</td>
      <td>141.397963</td>
      <td>19.246945</td>
      <td>275.779840</td>
      <td>641.468152</td>
      <td>74.042708</td>
      <td>2071.715856</td>
      <td>197.126067</td>
      <td>1</td>
      <td>6.313201</td>
      <td>58.261074</td>
    </tr>
    <tr>
      <th>921</th>
      <td>3.808020</td>
      <td>1890.413468</td>
      <td>417.316232</td>
      <td>129.183416</td>
      <td>27.474763</td>
      <td>300.952708</td>
      <td>758.747882</td>
      <td>74.309704</td>
      <td>2856.328932</td>
      <td>194.754342</td>
      <td>1</td>
      <td>6.078902</td>
      <td>77.434468</td>
    </tr>
  </tbody>
</table>
<p>922 rows × 13 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-995e9e65-5780-42d7-a8a9-33cc29a7dd94')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-995e9e65-5780-42d7-a8a9-33cc29a7dd94 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-995e9e65-5780-42d7-a8a9-33cc29a7dd94');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-03eaf04c-e465-4585-80ab-64ce42ee55b6">
  <button class="colab-df-quickchart" onclick="quickchart('df-03eaf04c-e465-4585-80ab-64ce42ee55b6')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-03eaf04c-e465-4585-80ab-64ce42ee55b6 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="suRYzcdB5IvH">
<p>Анализ данных показал отсутствие линейных зависимостей между
переменными, что подтверждается низкими значениями коэффициентов
корреляции.</p>
<p>С учетом характеристик исходных данных мы имеем три целевых признака
которые выражены следующим образом: модуль упругости при растяжении и
прочность при растяжении зависят от свойств матрицы, наполнителя и
параметров процесса, а соотношение матрица-наполнитель определяется
характеристиками матрицы, наполнителя и свойствами конечного композита.
В связи с этим необходимо построить предсказывающие модели для первых
двух признаков и разработать нейронную сеть для прогнозирования
последнего.</p>
</div>
<div class="cell markdown" id="Tjfn9lYHXeTG">
<p>Перед тем как передавать данные в модель, их необходимо привести к
удобному формату. Для этого выполняем предобработку, учитывая
особенности разных типов признаков.</p>
<p>Признак угла нашивки после преобразования дискретные значения,
поэтому для их кодирования используем OrdinalEncoder.</p>
<p>Для остальных - числовых переменных - выполняем стандартизацию с
помощью StandardScaler. Этот метод приводит данные к нормальному
распределению со средним значением 0 и стандартным отклонением 1, что
улучшает сходимость модели.</p>
</div>
<div class="cell code" id="k9bWbw6V8lc3">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># деление датасетов по целевому признаку для каждой из задач</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># для признака &quot;Модуль упругости при растяжении&quot;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>y1_columns <span class="op">=</span> [<span class="st">&#39;Модуль упругости при растяжении, ГПа&#39;</span>]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>x1_columns <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> df.columns <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> y1_columns]</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> df.loc[:, y1_columns]</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> df.loc[:, x1_columns]</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># для признака &quot;Прочность при растяжении&quot;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>y2_columns <span class="op">=</span> [<span class="st">&#39;Прочность при растяжении, МПа&#39;</span>]</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>x2_columns <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> df.columns <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> y2_columns]</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>y2 <span class="op">=</span> df.loc[:, y2_columns]</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>x2 <span class="op">=</span> df.loc[:, x2_columns]</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co"># для признака &quot;Соотношение матрица-наполнитель&quot;</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>y3_columns <span class="op">=</span> [<span class="st">&#39;Соотношение матрица-наполнитель&#39;</span>]</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>x3_columns <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> df.columns <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> y3_columns]</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>y3 <span class="op">=</span> df.loc[:, y3_columns]</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>x3 <span class="op">=</span> df.loc[:, x3_columns]</span></code></pre></div>
</div>
<div class="cell code" id="GPic75EEV01d">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># определяем категориальные и числовые признаки</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>categorial_feature <span class="op">=</span> [<span class="st">&#39;Угол нашивки&#39;</span>]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>num_features_x1 <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(x1_columns) <span class="op">-</span> <span class="bu">set</span>(categorial_feature))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>num_features_x2 <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(x2_columns) <span class="op">-</span> <span class="bu">set</span>(categorial_feature))</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>num_features_x3 <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(x3_columns) <span class="op">-</span> <span class="bu">set</span>(categorial_feature))</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># создаем препроцессоры для разных задач</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>preproc_1 <span class="op">=</span> ColumnTransformer(</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    transformers<span class="op">=</span>[</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&quot;scale_numeric&quot;</span>, StandardScaler(), num_features_x1),</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&quot;encode_categorical&quot;</span>, OrdinalEncoder(), categorial_feature)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>preproc_2 <span class="op">=</span> ColumnTransformer(</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    transformers<span class="op">=</span>[</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&quot;scale_numeric&quot;</span>, StandardScaler(), num_features_x2),</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&quot;encode_categorical&quot;</span>, OrdinalEncoder(), categorial_feature)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>preproc_3 <span class="op">=</span> ColumnTransformer(</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    transformers<span class="op">=</span>[</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&quot;scale_numeric&quot;</span>, StandardScaler(), num_features_x3),</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&quot;encode_categorical&quot;</span>, OrdinalEncoder(), categorial_feature)</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div class="cell markdown" id="BOAA1mhrhPfH">
<p>Определим вспомогательные функции, с помощью которых можно будет
сравнить метрики различных моделей</p>
</div>
<div class="cell code" id="ywoFha7imXwD">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># перечень моделей, на которых будет проходить обучение</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> {</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Dummy Regressor&#39;</span>: DummyRegressor(strategy<span class="op">=</span><span class="st">&#39;mean&#39;</span>),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Linear Regression&#39;</span>: LinearRegression(),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Ridge&#39;</span>: Ridge(),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Lasso&#39;</span>: Lasso(),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Gradient Boosting&#39;</span>: GradientBoostingRegressor(),</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;SVR&#39;</span>: SVR(),</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;KNN&#39;</span>: KNeighborsRegressor(),</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Decision Tree&#39;</span>: DecisionTreeRegressor(random_state<span class="op">=</span><span class="dv">42</span>),</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Random Forest&#39;</span>: RandomForestRegressor(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="cell code" id="TuzgRNkI9xoJ">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># функция для оценки моделей с базовыми параметрам с использованием кросс-валидации</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> evaluate_models(models, features, target):</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> pd.DataFrame(columns<span class="op">=</span>[<span class="st">&#39;R2&#39;</span>, <span class="st">&#39;RMSE&#39;</span>, <span class="st">&#39;MAE&#39;</span>, <span class="st">&#39;MAPE&#39;</span>])</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># настройка кросс-валидации</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    cv <span class="op">=</span> KFold(n_splits<span class="op">=</span><span class="dv">10</span>, shuffle<span class="op">=</span><span class="va">True</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Определяем метрики для оценки</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    metrics <span class="op">=</span> {</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;R2&#39;</span>: <span class="st">&#39;r2&#39;</span>,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;RMSE&#39;</span>: <span class="st">&#39;neg_root_mean_squared_error&#39;</span>,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;MAE&#39;</span>: <span class="st">&#39;neg_mean_absolute_error&#39;</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;MAPE&#39;</span>: <span class="st">&#39;neg_mean_absolute_percentage_error&#39;</span>,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># проходим по каждой модели</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> model_name, model <span class="kw">in</span> models.items():</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># выполняем кросс-валидацию</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>        cv_results <span class="op">=</span> cross_validate(model, features, target, cv<span class="op">=</span>cv, scoring<span class="op">=</span><span class="bu">list</span>(metrics.values()))</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># сохраняем средние значения метрик</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>        results.loc[model_name, <span class="st">&#39;R2&#39;</span>] <span class="op">=</span> cv_results[<span class="st">&#39;test_r2&#39;</span>].mean()</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>        results.loc[model_name, <span class="st">&#39;RMSE&#39;</span>] <span class="op">=</span> <span class="op">-</span>cv_results[<span class="st">&#39;test_neg_root_mean_squared_error&#39;</span>].mean()</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>        results.loc[model_name, <span class="st">&#39;MAE&#39;</span>] <span class="op">=</span> <span class="op">-</span>cv_results[<span class="st">&#39;test_neg_mean_absolute_error&#39;</span>].mean()</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>        results.loc[model_name, <span class="st">&#39;MAPE&#39;</span>] <span class="op">=</span> <span class="op">-</span>cv_results[<span class="st">&#39;test_neg_mean_absolute_percentage_error&#39;</span>].mean()</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span></code></pre></div>
</div>
<div class="cell code" id="4m8HHnlzmFoV">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># функция для поиска оптимальных параметров моделей</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> grid_search(model, params, x, y):</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    pd.options.display.max_colwidth <span class="op">=</span> <span class="dv">100</span> <span class="co"># чтобы полностью отобразить оптимальные параметры при выводе</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> pd.DataFrame()</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    cv <span class="op">=</span> KFold(<span class="dv">10</span>, shuffle<span class="op">=</span><span class="va">True</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    scoring <span class="op">=</span> <span class="st">&#39;neg_root_mean_squared_error&#39;</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    searcher <span class="op">=</span> GridSearchCV(model, params, cv<span class="op">=</span>cv, scoring<span class="op">=</span>scoring)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    searcher.fit(x, y)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    results.loc[:, <span class="st">&#39;best parameters&#39;</span>] <span class="op">=</span> searcher.cv_results_[<span class="st">&#39;params&#39;</span>]</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    results.loc[:, <span class="st">&#39;RMSE&#39;</span>] <span class="op">=</span> <span class="op">-</span>searcher.cv_results_[<span class="st">&#39;mean_test_score&#39;</span>]</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    results.loc[:, <span class="st">&#39;rank&#39;</span>] <span class="op">=</span> searcher.cv_results_[<span class="st">&#39;rank_test_score&#39;</span>]</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results, searcher.best_estimator_</span></code></pre></div>
</div>
<div class="cell code" id="QK_yeoeZMn5j">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># расчет метрик качества предсказания модели</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_metrics(model_name, true_values, predicted_values):</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> pd.DataFrame(index<span class="op">=</span>[model_name], columns<span class="op">=</span>[<span class="st">&#39;R2&#39;</span>, <span class="st">&#39;RMSE&#39;</span>, <span class="st">&#39;MAE&#39;</span>, <span class="st">&#39;MAPE&#39;</span>])</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    results.loc[model_name, <span class="st">&#39;R2&#39;</span>] <span class="op">=</span> metrics.r2_score(true_values, predicted_values)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    mse <span class="op">=</span> metrics.mean_squared_error(true_values, predicted_values)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    results.loc[model_name, <span class="st">&quot;RMSE&quot;</span>] <span class="op">=</span> np.sqrt(mse)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># results.loc[model_name, &#39;RMSE&#39;] = metrics.mean_squared_error(true_values, predicted_values, squared=False)</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    results.loc[model_name, <span class="st">&#39;MAE&#39;</span>] <span class="op">=</span> metrics.mean_absolute_error(true_values, predicted_values)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    results.loc[model_name, <span class="st">&#39;MAPE&#39;</span>] <span class="op">=</span> metrics.mean_absolute_percentage_error(true_values, predicted_values)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span></code></pre></div>
</div>
<div class="cell code" id="9MOgl7Xf0iKv">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Функция применяет стилизацию к DataFrame:</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Минимальные RMSE, MAE, MAPE — зеленым</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Максимальное R² — зеленым</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Максимальные RMSE, MAE, MAPE — синим</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Минимальный R² — синим</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> style_model_results(df):</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (df.style</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>            .highlight_min(subset<span class="op">=</span>[<span class="st">&#39;RMSE&#39;</span>, <span class="st">&#39;MAE&#39;</span>, <span class="st">&#39;MAPE&#39;</span>], color<span class="op">=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>            .highlight_max(subset<span class="op">=</span>[<span class="st">&#39;R2&#39;</span>], color<span class="op">=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>            .highlight_max(subset<span class="op">=</span>[<span class="st">&#39;RMSE&#39;</span>, <span class="st">&#39;MAE&#39;</span>, <span class="st">&#39;MAPE&#39;</span>], color<span class="op">=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>            .highlight_min(subset<span class="op">=</span>[<span class="st">&#39;R2&#39;</span>], color<span class="op">=</span><span class="st">&quot;blue&quot;</span>))</span></code></pre></div>
</div>
<section id="1ый-целевой-параметр---модуль-упругости-при-растяжении"
class="cell markdown" id="xnU6yL7IQ6hV">
<h1>1ый целевой параметр - модуль упругости при растяжении</h1>
</section>
<div class="cell code" id="aXM_LplxRFY-">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># разделяем выборки</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>x1_train_initial, x1_test_initial, y1_train, y1_test <span class="op">=</span> train_test_split(x1, y1, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># преобразуем целевой параметр в массив</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>y1_train <span class="op">=</span> y1_train[<span class="st">&#39;Модуль упругости при растяжении, ГПа&#39;</span>].values</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>y1_test <span class="op">=</span> y1_test[<span class="st">&#39;Модуль упругости при растяжении, ГПа&#39;</span>].values</span></code></pre></div>
</div>
<div class="cell code" id="Xj-HdnYRalQe">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># препроцессинг</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>x1_train <span class="op">=</span> preproc_1.fit_transform(x1_train_initial)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>x1_test <span class="op">=</span> preproc_1.transform(x1_test_initial)</span></code></pre></div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:332}"
id="spQKI_ikSnKV" data-outputId="492781db-0a5e-49ef-8126-e136e6eaf8cd">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>results_1 <span class="op">=</span> evaluate_models(models, x1_train, y1_train)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>styled_results_1 <span class="op">=</span> style_model_results(results_1)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>styled_results_1</span></code></pre></div>
<div class="output execute_result" data-execution_count="131">
<style type="text/css">
#T_7a7b9_row0_col0, #T_7a7b9_row0_col1, #T_7a7b9_row0_col2, #T_7a7b9_row0_col3, #T_7a7b9_row3_col0, #T_7a7b9_row3_col1, #T_7a7b9_row3_col2, #T_7a7b9_row3_col3 {
  background-color: green;
}
#T_7a7b9_row7_col0, #T_7a7b9_row7_col1, #T_7a7b9_row7_col2, #T_7a7b9_row7_col3 {
  background-color: blue;
}
</style>
<table id="T_7a7b9" class="dataframe">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_7a7b9_level0_col0" class="col_heading level0 col0" >R2</th>
      <th id="T_7a7b9_level0_col1" class="col_heading level0 col1" >RMSE</th>
      <th id="T_7a7b9_level0_col2" class="col_heading level0 col2" >MAE</th>
      <th id="T_7a7b9_level0_col3" class="col_heading level0 col3" >MAPE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_7a7b9_level0_row0" class="row_heading level0 row0" >Dummy Regressor</th>
      <td id="T_7a7b9_row0_col0" class="data row0 col0" >-0.005978</td>
      <td id="T_7a7b9_row0_col1" class="data row0 col1" >2.959776</td>
      <td id="T_7a7b9_row0_col2" class="data row0 col2" >2.391135</td>
      <td id="T_7a7b9_row0_col3" class="data row0 col3" >0.032699</td>
    </tr>
    <tr>
      <th id="T_7a7b9_level0_row1" class="row_heading level0 row1" >Linear Regression</th>
      <td id="T_7a7b9_row1_col0" class="data row1 col0" >-0.026962</td>
      <td id="T_7a7b9_row1_col1" class="data row1 col1" >2.989545</td>
      <td id="T_7a7b9_row1_col2" class="data row1 col2" >2.427342</td>
      <td id="T_7a7b9_row1_col3" class="data row1 col3" >0.033198</td>
    </tr>
    <tr>
      <th id="T_7a7b9_level0_row2" class="row_heading level0 row2" >Ridge</th>
      <td id="T_7a7b9_row2_col0" class="data row2 col0" >-0.026884</td>
      <td id="T_7a7b9_row2_col1" class="data row2 col1" >2.989433</td>
      <td id="T_7a7b9_row2_col2" class="data row2 col2" >2.427215</td>
      <td id="T_7a7b9_row2_col3" class="data row2 col3" >0.033197</td>
    </tr>
    <tr>
      <th id="T_7a7b9_level0_row3" class="row_heading level0 row3" >Lasso</th>
      <td id="T_7a7b9_row3_col0" class="data row3 col0" >-0.005978</td>
      <td id="T_7a7b9_row3_col1" class="data row3 col1" >2.959776</td>
      <td id="T_7a7b9_row3_col2" class="data row3 col2" >2.391135</td>
      <td id="T_7a7b9_row3_col3" class="data row3 col3" >0.032699</td>
    </tr>
    <tr>
      <th id="T_7a7b9_level0_row4" class="row_heading level0 row4" >Gradient Boosting</th>
      <td id="T_7a7b9_row4_col0" class="data row4 col0" >-0.136563</td>
      <td id="T_7a7b9_row4_col1" class="data row4 col1" >3.143007</td>
      <td id="T_7a7b9_row4_col2" class="data row4 col2" >2.533132</td>
      <td id="T_7a7b9_row4_col3" class="data row4 col3" >0.034653</td>
    </tr>
    <tr>
      <th id="T_7a7b9_level0_row5" class="row_heading level0 row5" >SVR</th>
      <td id="T_7a7b9_row5_col0" class="data row5 col0" >-0.060587</td>
      <td id="T_7a7b9_row5_col1" class="data row5 col1" >3.036800</td>
      <td id="T_7a7b9_row5_col2" class="data row5 col2" >2.468571</td>
      <td id="T_7a7b9_row5_col3" class="data row5 col3" >0.033731</td>
    </tr>
    <tr>
      <th id="T_7a7b9_level0_row6" class="row_heading level0 row6" >KNN</th>
      <td id="T_7a7b9_row6_col0" class="data row6 col0" >-0.220369</td>
      <td id="T_7a7b9_row6_col1" class="data row6 col1" >3.253134</td>
      <td id="T_7a7b9_row6_col2" class="data row6 col2" >2.637365</td>
      <td id="T_7a7b9_row6_col3" class="data row6 col3" >0.036116</td>
    </tr>
    <tr>
      <th id="T_7a7b9_level0_row7" class="row_heading level0 row7" >Decision Tree</th>
      <td id="T_7a7b9_row7_col0" class="data row7 col0" >-1.259385</td>
      <td id="T_7a7b9_row7_col1" class="data row7 col1" >4.419100</td>
      <td id="T_7a7b9_row7_col2" class="data row7 col2" >3.621063</td>
      <td id="T_7a7b9_row7_col3" class="data row7 col3" >0.049494</td>
    </tr>
    <tr>
      <th id="T_7a7b9_level0_row8" class="row_heading level0 row8" >Random Forest</th>
      <td id="T_7a7b9_row8_col0" class="data row8 col0" >-0.075859</td>
      <td id="T_7a7b9_row8_col1" class="data row8 col1" >3.060216</td>
      <td id="T_7a7b9_row8_col2" class="data row8 col2" >2.479546</td>
      <td id="T_7a7b9_row8_col3" class="data row8 col3" >0.033924</td>
    </tr>
  </tbody>
</table>

</div>
</div>
<div class="cell markdown" id="GyhRET6M7AQn">
<p>Как можно видеть из результатов работы моделей коэффициент
детерминации во всех моделях почти равен нулю (все они приняли
отрицательное значение), то есть все они (за исключением лассо) показали
себя хуже базовой модели.</p>
</div>
<div class="cell code" id="fG62R3CfpWJy">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создаем dict с лучшими параметрами моделей</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>GS_best_models_1 <span class="op">=</span> {}</span></code></pre></div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:81}"
id="3aACEFNDqUo6" data-outputId="8f12bce1-cd97-4c7e-8691-93a2e20e6408">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># для обычной линейной регрессии нет возможности для перебора параметров, поэтому ее в данном случае не рассматриваем</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># лучшие параметры для модели Ridge</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>params_1 <span class="op">=</span> {</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;alpha&#39;</span>: <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">10</span><span class="op">**</span><span class="dv">6</span>, <span class="dv">5000</span>),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;fit_intercept&#39;</span>: [<span class="va">True</span>, <span class="va">False</span>],</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;solver&#39;</span>: [<span class="st">&#39;auto&#39;</span>, <span class="st">&#39;svd&#39;</span>, <span class="st">&#39;cholesky&#39;</span>, <span class="st">&#39;lsqr&#39;</span>, <span class="st">&#39;sag&#39;</span>, <span class="st">&#39;saga&#39;</span>]</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>search, best_model <span class="op">=</span> grid_search(Ridge(), params_1, x1_train, y1_train)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co"># сохранение лучшей модели в словарь</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>GS_best_models_1[<span class="bu">str</span>(best_model)] <span class="op">=</span> best_model</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co"># вывод результатов для лучшей модели</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>search.loc[search[<span class="st">&#39;rank&#39;</span>] <span class="op">==</span> <span class="dv">1</span>, [<span class="st">&#39;best parameters&#39;</span>, <span class="st">&#39;RMSE&#39;</span>]]</span></code></pre></div>
<div class="output execute_result" data-execution_count="133">

  <div id="df-66596512-45f0-42a7-8f51-3a008a194071" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>best parameters</th>
      <th>RMSE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2308</th>
      <td>{'alpha': 960001, 'fit_intercept': True, 'solver': 'sag'}</td>
      <td>2.959782</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-66596512-45f0-42a7-8f51-3a008a194071')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-66596512-45f0-42a7-8f51-3a008a194071 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-66596512-45f0-42a7-8f51-3a008a194071');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:81}"
id="SNAmLqVQ11uL" data-outputId="f365a10f-d1de-4389-feb4-b84092a19537">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># лучшие параметры для модели Lasso</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>params_1 <span class="op">=</span> {</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;alpha&#39;</span>: [<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>, <span class="fl">0.15</span>, <span class="fl">0.2</span>, <span class="fl">0.095</span>, <span class="dv">1</span>],</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;fit_intercept&#39;</span>: [<span class="va">True</span>, <span class="va">False</span>],</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>search, best_model <span class="op">=</span> grid_search(Lasso(), params_1, x1_train, y1_train)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Сохранение лучшей модели в словарь</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>GS_best_models_1[<span class="bu">str</span>(best_model)] <span class="op">=</span> best_model</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Вывод результатов для лучшей модели</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>search.loc[search[<span class="st">&#39;rank&#39;</span>] <span class="op">==</span> <span class="dv">1</span>, [<span class="st">&#39;best parameters&#39;</span>, <span class="st">&#39;RMSE&#39;</span>]]</span></code></pre></div>
<div class="output execute_result" data-execution_count="134">

  <div id="df-95837470-74fc-4ea7-88d6-a9e5a0f65c4c" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>best parameters</th>
      <th>RMSE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>14</th>
      <td>{'alpha': 1, 'fit_intercept': True}</td>
      <td>2.959776</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-95837470-74fc-4ea7-88d6-a9e5a0f65c4c')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-95837470-74fc-4ea7-88d6-a9e5a0f65c4c button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-95837470-74fc-4ea7-88d6-a9e5a0f65c4c');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:81}"
id="ArXvA6a87Hib" data-outputId="b5f9972f-e80b-49e7-87fc-3ea0736eaa70">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># лучшие параметры для модели градиентного бустинга</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>params_1 <span class="op">=</span> {</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;n_estimators&#39;</span>: [<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">25</span>],</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;learning_rate&#39;</span>: [<span class="fl">0.05</span>, <span class="fl">0.2</span>],</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;max_depth&#39;</span>: [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>],</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;min_samples_split&#39;</span>: [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">7</span>],</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;min_samples_leaf&#39;</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>],</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;subsample&#39;</span>: [<span class="fl">0.5</span>, <span class="fl">1.0</span>]</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>search, best_model <span class="op">=</span> grid_search(GradientBoostingRegressor(), params_1, x1_train, y1_train)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Сохранение лучшей модели в словарь</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>GS_best_models_1[<span class="bu">str</span>(best_model)] <span class="op">=</span> best_model</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Вывод результатов для лучшей модели</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>search.loc[search[<span class="st">&#39;rank&#39;</span>] <span class="op">==</span> <span class="dv">1</span>, [<span class="st">&#39;best parameters&#39;</span>, <span class="st">&#39;RMSE&#39;</span>]]</span></code></pre></div>
<div class="output execute_result" data-execution_count="135">

  <div id="df-ab3ee99d-d613-4e46-b5fd-d9c4fea035b8" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>best parameters</th>
      <th>RMSE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>{'learning_rate': 0.05, 'max_depth': 3, 'min_samples_leaf': 1, 'min_samples_split': 2, 'n_estima...</td>
      <td>2.959441</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ab3ee99d-d613-4e46-b5fd-d9c4fea035b8')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ab3ee99d-d613-4e46-b5fd-d9c4fea035b8 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ab3ee99d-d613-4e46-b5fd-d9c4fea035b8');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:81}"
id="Knf7_NoBcNAK" data-outputId="a580a1ac-db33-4b73-abf2-f81ddcd266ed">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># лучшие параметры для метода опорных векторов</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>params_1 <span class="op">=</span> {</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;C&#39;</span>: [<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>],</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;kernel&#39;</span>: [<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;rbf&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;sigmoid&#39;</span>]</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>search, best_model <span class="op">=</span> grid_search(SVR(), params_1, x1_train, y1_train)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Сохранение лучшей модели в словарь</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>GS_best_models_1[<span class="bu">str</span>(best_model)] <span class="op">=</span> best_model</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Вывод результатов для лучшей модели</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>search.loc[search[<span class="st">&#39;rank&#39;</span>] <span class="op">==</span> <span class="dv">1</span>, [<span class="st">&#39;best parameters&#39;</span>, <span class="st">&#39;RMSE&#39;</span>]]</span></code></pre></div>
<div class="output execute_result" data-execution_count="136">

  <div id="df-8d3c1a0f-be88-4f7e-a827-ee7f31891b13" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>best parameters</th>
      <th>RMSE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>{'C': 0.001, 'kernel': 'rbf'}</td>
      <td>2.96376</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-8d3c1a0f-be88-4f7e-a827-ee7f31891b13')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-8d3c1a0f-be88-4f7e-a827-ee7f31891b13 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-8d3c1a0f-be88-4f7e-a827-ee7f31891b13');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:81}"
id="a5wIis3MMIDT" data-outputId="dceae686-58b0-4a6c-a960-40aa64a0d136">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># лучшие параметры для KNN</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>params_1 <span class="op">=</span> {</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;n_neighbors&#39;</span>: [<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>],</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;weights&#39;</span>: [<span class="st">&#39;uniform&#39;</span>, <span class="st">&#39;distance&#39;</span>],</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;metric&#39;</span>: [<span class="st">&#39;euclidean&#39;</span>, <span class="st">&#39;manhattan&#39;</span>, <span class="st">&#39;minkowski&#39;</span>, <span class="st">&#39;chebyshev&#39;</span>],</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>search, best_model <span class="op">=</span> grid_search(KNeighborsRegressor(), params_1, x1_train, y1_train)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Сохранение лучшей модели в словарь</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>GS_best_models_1[<span class="bu">str</span>(best_model)] <span class="op">=</span> best_model</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Вывод результатов для лучшей модели</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>search.loc[search[<span class="st">&#39;rank&#39;</span>] <span class="op">==</span> <span class="dv">1</span>, [<span class="st">&#39;best parameters&#39;</span>, <span class="st">&#39;RMSE&#39;</span>]]</span></code></pre></div>
<div class="output execute_result" data-execution_count="137">

  <div id="df-86d38bc9-18a4-4e7a-9bb5-841c20dd0c5a" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>best parameters</th>
      <th>RMSE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>30</th>
      <td>{'metric': 'chebyshev', 'n_neighbors': 9, 'weights': 'uniform'}</td>
      <td>3.057479</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-86d38bc9-18a4-4e7a-9bb5-841c20dd0c5a')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-86d38bc9-18a4-4e7a-9bb5-841c20dd0c5a button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-86d38bc9-18a4-4e7a-9bb5-841c20dd0c5a');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:81}"
id="eT2_Yp9n1beN" data-outputId="a6eba1d7-4f76-4bf5-8ed5-09729cefccb8">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># лучшие параметры для Decision Tree</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>params_1 <span class="op">=</span> {</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;max_depth&#39;</span>: [<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">10</span>],</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;min_samples_split&#39;</span>: [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>],</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;min_samples_leaf&#39;</span>: [<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>],</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;criterion&#39;</span>: [<span class="st">&#39;squared_error&#39;</span>, <span class="st">&#39;absolute_error&#39;</span>, <span class="st">&#39;friedman_mse&#39;</span>]</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>search, best_model <span class="op">=</span> grid_search(DecisionTreeRegressor(), params_1, x1_train, y1_train)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Сохранение лучшей модели в словарь</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>GS_best_models_1[<span class="bu">str</span>(best_model)] <span class="op">=</span> best_model</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Вывод результатов для лучшей модели</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>search.loc[search[<span class="st">&#39;rank&#39;</span>] <span class="op">==</span> <span class="dv">1</span>, [<span class="st">&#39;best parameters&#39;</span>, <span class="st">&#39;RMSE&#39;</span>]]</span></code></pre></div>
<div class="output execute_result" data-execution_count="138">

  <div id="df-31d63562-6697-4fca-9b5d-a79a72194a84" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>best parameters</th>
      <th>RMSE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>60</th>
      <td>{'criterion': 'friedman_mse', 'max_depth': 3, 'min_samples_leaf': 10, 'min_samples_split': 2}</td>
      <td>3.073318</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-31d63562-6697-4fca-9b5d-a79a72194a84')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-31d63562-6697-4fca-9b5d-a79a72194a84 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-31d63562-6697-4fca-9b5d-a79a72194a84');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:81}"
id="T0zlQimViFzj" data-outputId="c8dd88a8-6e85-4df3-f3bc-747dc501f8ea">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># лучшие параметры для Random Forest</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>params_1 <span class="op">=</span> {</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;n_estimators&#39;</span>: [<span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">10</span>],</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;max_depth&#39;</span>: [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">6</span>],</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;min_samples_split&#39;</span>: [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">7</span>],</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;min_samples_leaf&#39;</span>: [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">7</span>],</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;criterion&#39;</span>: [<span class="st">&#39;squared_error&#39;</span>, <span class="st">&#39;absolute_error&#39;</span>],</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;bootstrap&#39;</span>: [<span class="va">True</span>, <span class="va">False</span>]</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>search, best_model <span class="op">=</span> grid_search(RandomForestRegressor(), params_1, x1_train, y1_train)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Сохранение лучшей модели в словарь</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>GS_best_models_1[<span class="bu">str</span>(best_model)] <span class="op">=</span> best_model</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Вывод результатов для лучшей модели</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>search.loc[search[<span class="st">&#39;rank&#39;</span>] <span class="op">==</span> <span class="dv">1</span>, [<span class="st">&#39;best parameters&#39;</span>, <span class="st">&#39;RMSE&#39;</span>]]</span></code></pre></div>
<div class="output execute_result" data-execution_count="139">

  <div id="df-c9a812fe-b462-4313-b811-53518f03a501" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>best parameters</th>
      <th>RMSE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>44</th>
      <td>{'bootstrap': True, 'criterion': 'squared_error', 'max_depth': 4, 'min_samples_leaf': 5, 'min_sa...</td>
      <td>2.990873</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c9a812fe-b462-4313-b811-53518f03a501')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c9a812fe-b462-4313-b811-53518f03a501 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c9a812fe-b462-4313-b811-53518f03a501');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:269}"
id="N_00cDDNY7M1" data-outputId="41ba181f-4098-4e61-e64b-221a5ddc81ac">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mod_results_1 <span class="op">=</span> evaluate_models(GS_best_models_1, x1_train, y1_train)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>styled_mod_results_1 <span class="op">=</span> style_model_results(mod_results_1)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>styled_mod_results_1</span></code></pre></div>
<div class="output execute_result" data-execution_count="140">
<style type="text/css">
#T_e9f48_row1_col0, #T_e9f48_row1_col1, #T_e9f48_row1_col2, #T_e9f48_row1_col3 {
  background-color: green;
}
#T_e9f48_row5_col0, #T_e9f48_row5_col1, #T_e9f48_row5_col2, #T_e9f48_row5_col3 {
  background-color: blue;
}
</style>
<table id="T_e9f48" class="dataframe">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_e9f48_level0_col0" class="col_heading level0 col0" >R2</th>
      <th id="T_e9f48_level0_col1" class="col_heading level0 col1" >RMSE</th>
      <th id="T_e9f48_level0_col2" class="col_heading level0 col2" >MAE</th>
      <th id="T_e9f48_level0_col3" class="col_heading level0 col3" >MAPE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_e9f48_level0_row0" class="row_heading level0 row0" >Ridge(alpha=960001, solver='sag')</th>
      <td id="T_e9f48_row0_col0" class="data row0 col0" >-0.005983</td>
      <td id="T_e9f48_row0_col1" class="data row0 col1" >2.959782</td>
      <td id="T_e9f48_row0_col2" class="data row0 col2" >2.391149</td>
      <td id="T_e9f48_row0_col3" class="data row0 col3" >0.032699</td>
    </tr>
    <tr>
      <th id="T_e9f48_level0_row1" class="row_heading level0 row1" >Lasso(alpha=1)</th>
      <td id="T_e9f48_row1_col0" class="data row1 col0" >-0.005978</td>
      <td id="T_e9f48_row1_col1" class="data row1 col1" >2.959776</td>
      <td id="T_e9f48_row1_col2" class="data row1 col2" >2.391135</td>
      <td id="T_e9f48_row1_col3" class="data row1 col3" >0.032699</td>
    </tr>
    <tr>
      <th id="T_e9f48_level0_row2" class="row_heading level0 row2" >GradientBoostingRegressor(learning_rate=0.05, n_estimators=5, subsample=0.5)</th>
      <td id="T_e9f48_row2_col0" class="data row2 col0" >-0.009317</td>
      <td id="T_e9f48_row2_col1" class="data row2 col1" >2.964935</td>
      <td id="T_e9f48_row2_col2" class="data row2 col2" >2.396990</td>
      <td id="T_e9f48_row2_col3" class="data row2 col3" >0.032780</td>
    </tr>
    <tr>
      <th id="T_e9f48_level0_row3" class="row_heading level0 row3" >SVR(C=0.001)</th>
      <td id="T_e9f48_row3_col0" class="data row3 col0" >-0.008681</td>
      <td id="T_e9f48_row3_col1" class="data row3 col1" >2.963760</td>
      <td id="T_e9f48_row3_col2" class="data row3 col2" >2.398581</td>
      <td id="T_e9f48_row3_col3" class="data row3 col3" >0.032777</td>
    </tr>
    <tr>
      <th id="T_e9f48_level0_row4" class="row_heading level0 row4" >KNeighborsRegressor(metric='chebyshev', n_neighbors=9)</th>
      <td id="T_e9f48_row4_col0" class="data row4 col0" >-0.077981</td>
      <td id="T_e9f48_row4_col1" class="data row4 col1" >3.057479</td>
      <td id="T_e9f48_row4_col2" class="data row4 col2" >2.459564</td>
      <td id="T_e9f48_row4_col3" class="data row4 col3" >0.033687</td>
    </tr>
    <tr>
      <th id="T_e9f48_level0_row5" class="row_heading level0 row5" >DecisionTreeRegressor(criterion='friedman_mse', max_depth=3,
                      min_samples_leaf=10)</th>
      <td id="T_e9f48_row5_col0" class="data row5 col0" >-0.083898</td>
      <td id="T_e9f48_row5_col1" class="data row5 col1" >3.073318</td>
      <td id="T_e9f48_row5_col2" class="data row5 col2" >2.469612</td>
      <td id="T_e9f48_row5_col3" class="data row5 col3" >0.033780</td>
    </tr>
    <tr>
      <th id="T_e9f48_level0_row6" class="row_heading level0 row6" >RandomForestRegressor(max_depth=4, min_samples_leaf=5, min_samples_split=7,
                      n_estimators=10)</th>
      <td id="T_e9f48_row6_col0" class="data row6 col0" >-0.064110</td>
      <td id="T_e9f48_row6_col1" class="data row6 col1" >3.046009</td>
      <td id="T_e9f48_row6_col2" class="data row6 col2" >2.464654</td>
      <td id="T_e9f48_row6_col3" class="data row6 col3" >0.033707</td>
    </tr>
  </tbody>
</table>

</div>
</div>
<div class="cell code" id="aSk3rhOgPSzI">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>best_model_1 <span class="op">=</span> Lasso(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>     alpha <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>best_model_1.fit(x1_train, y1_train)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>y1_best <span class="op">=</span> best_model_1.predict(x1_test)</span></code></pre></div>
</div>
<div class="cell code" id="ojkQHSYcj-VF">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>base_model_1 <span class="op">=</span> DummyRegressor(strategy<span class="op">=</span><span class="st">&#39;mean&#39;</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>base_model_1.fit(x1_train, y1_train)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>y1_dummy_predicted <span class="op">=</span> base_model_1.predict(x1_test)</span></code></pre></div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:112}"
id="Zz3k1Xc5k8Cu" data-outputId="2041e7b0-eded-4423-ab9e-e0f44b426798">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>diff_stats_1 <span class="op">=</span> calculate_metrics(<span class="st">&#39;Базовая модель&#39;</span>, y1_test, y1_dummy_predicted)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>diff_stats_1 <span class="op">=</span> pd.concat([diff_stats_1, calculate_metrics(<span class="st">&#39;Лучшая модель (Lasso)&#39;</span>, y1_test, y1_best)], ignore_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>diff_stats_1</span></code></pre></div>
<div class="output execute_result" data-execution_count="143">

  <div id="df-b626c35c-d126-4b12-91e6-029a1e4cc311" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>R2</th>
      <th>RMSE</th>
      <th>MAE</th>
      <th>MAPE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Базовая модель</th>
      <td>-0.008879</td>
      <td>3.162017</td>
      <td>2.580193</td>
      <td>0.035032</td>
    </tr>
    <tr>
      <th>Лучшая модель (Lasso)</th>
      <td>-0.008879</td>
      <td>3.162017</td>
      <td>2.580193</td>
      <td>0.035032</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-b626c35c-d126-4b12-91e6-029a1e4cc311')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-b626c35c-d126-4b12-91e6-029a1e4cc311 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-b626c35c-d126-4b12-91e6-029a1e4cc311');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-3e662f33-00cd-4679-837f-a07a4768ed90">
  <button class="colab-df-quickchart" onclick="quickchart('df-3e662f33-00cd-4679-837f-a07a4768ed90')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-3e662f33-00cd-4679-837f-a07a4768ed90 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<section id="2ой-целевой-параметр---прочность-при-растяжении"
class="cell markdown" id="D8O_QVa9eA4n">
<h1>2ой целевой параметр - прочность при растяжении</h1>
</section>
<div class="cell code" id="hgvougCXeHkv">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># разделяем выборки</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>x2_train_initial, x2_test_initial, y2_train, y2_test <span class="op">=</span> train_test_split(x2, y2, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># преобразуем целевой параметр в массив</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>y2_train <span class="op">=</span> y2_train[<span class="st">&#39;Прочность при растяжении, МПа&#39;</span>].values</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>y2_test <span class="op">=</span> y2_test[<span class="st">&#39;Прочность при растяжении, МПа&#39;</span>].values</span></code></pre></div>
</div>
<div class="cell code" id="TmhOQkpohQdJ">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># препроцессинг</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>x2_train <span class="op">=</span> preproc_2.fit_transform(x2_train_initial)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>x2_test <span class="op">=</span> preproc_2.transform(x2_test_initial)</span></code></pre></div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:332}"
id="7Gm9fx51ebQx" data-outputId="82b6ee39-e78a-4939-c11b-1ac5a54b0952">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>results_2 <span class="op">=</span> evaluate_models(models, x2_train, y2_train)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>styled_results_2 <span class="op">=</span> style_model_results(results_2)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>styled_results_2</span></code></pre></div>
<div class="output execute_result" data-execution_count="146">
<style type="text/css">
#T_626b3_row0_col0, #T_626b3_row0_col1, #T_626b3_row0_col2, #T_626b3_row5_col3 {
  background-color: green;
}
#T_626b3_row7_col0, #T_626b3_row7_col1, #T_626b3_row7_col2, #T_626b3_row7_col3 {
  background-color: blue;
}
</style>
<table id="T_626b3" class="dataframe">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_626b3_level0_col0" class="col_heading level0 col0" >R2</th>
      <th id="T_626b3_level0_col1" class="col_heading level0 col1" >RMSE</th>
      <th id="T_626b3_level0_col2" class="col_heading level0 col2" >MAE</th>
      <th id="T_626b3_level0_col3" class="col_heading level0 col3" >MAPE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_626b3_level0_row0" class="row_heading level0 row0" >Dummy Regressor</th>
      <td id="T_626b3_row0_col0" class="data row0 col0" >-0.008783</td>
      <td id="T_626b3_row0_col1" class="data row0 col1" >448.544529</td>
      <td id="T_626b3_row0_col2" class="data row0 col2" >358.490113</td>
      <td id="T_626b3_row0_col3" class="data row0 col3" >0.155329</td>
    </tr>
    <tr>
      <th id="T_626b3_level0_row1" class="row_heading level0 row1" >Linear Regression</th>
      <td id="T_626b3_row1_col0" class="data row1 col0" >-0.038337</td>
      <td id="T_626b3_row1_col1" class="data row1 col1" >455.122689</td>
      <td id="T_626b3_row1_col2" class="data row1 col2" >364.421774</td>
      <td id="T_626b3_row1_col3" class="data row1 col3" >0.157442</td>
    </tr>
    <tr>
      <th id="T_626b3_level0_row2" class="row_heading level0 row2" >Ridge</th>
      <td id="T_626b3_row2_col0" class="data row2 col0" >-0.038218</td>
      <td id="T_626b3_row2_col1" class="data row2 col1" >455.096808</td>
      <td id="T_626b3_row2_col2" class="data row2 col2" >364.398516</td>
      <td id="T_626b3_row2_col3" class="data row2 col3" >0.157433</td>
    </tr>
    <tr>
      <th id="T_626b3_level0_row3" class="row_heading level0 row3" >Lasso</th>
      <td id="T_626b3_row3_col0" class="data row3 col0" >-0.035833</td>
      <td id="T_626b3_row3_col1" class="data row3 col1" >454.589948</td>
      <td id="T_626b3_row3_col2" class="data row3 col2" >363.969117</td>
      <td id="T_626b3_row3_col3" class="data row3 col3" >0.157269</td>
    </tr>
    <tr>
      <th id="T_626b3_level0_row4" class="row_heading level0 row4" >Gradient Boosting</th>
      <td id="T_626b3_row4_col0" class="data row4 col0" >-0.083286</td>
      <td id="T_626b3_row4_col1" class="data row4 col1" >465.007333</td>
      <td id="T_626b3_row4_col2" class="data row4 col2" >374.990667</td>
      <td id="T_626b3_row4_col3" class="data row4 col3" >0.161850</td>
    </tr>
    <tr>
      <th id="T_626b3_level0_row5" class="row_heading level0 row5" >SVR</th>
      <td id="T_626b3_row5_col0" class="data row5 col0" >-0.008824</td>
      <td id="T_626b3_row5_col1" class="data row5 col1" >448.566744</td>
      <td id="T_626b3_row5_col2" class="data row5 col2" >358.793042</td>
      <td id="T_626b3_row5_col3" class="data row5 col3" >0.155192</td>
    </tr>
    <tr>
      <th id="T_626b3_level0_row6" class="row_heading level0 row6" >KNN</th>
      <td id="T_626b3_row6_col0" class="data row6 col0" >-0.165694</td>
      <td id="T_626b3_row6_col1" class="data row6 col1" >481.601403</td>
      <td id="T_626b3_row6_col2" class="data row6 col2" >381.265105</td>
      <td id="T_626b3_row6_col3" class="data row6 col3" >0.165831</td>
    </tr>
    <tr>
      <th id="T_626b3_level0_row7" class="row_heading level0 row7" >Decision Tree</th>
      <td id="T_626b3_row7_col0" class="data row7 col0" >-1.075977</td>
      <td id="T_626b3_row7_col1" class="data row7 col1" >640.658073</td>
      <td id="T_626b3_row7_col2" class="data row7 col2" >519.497292</td>
      <td id="T_626b3_row7_col3" class="data row7 col3" >0.222255</td>
    </tr>
    <tr>
      <th id="T_626b3_level0_row8" class="row_heading level0 row8" >Random Forest</th>
      <td id="T_626b3_row8_col0" class="data row8 col0" >-0.057140</td>
      <td id="T_626b3_row8_col1" class="data row8 col1" >459.366211</td>
      <td id="T_626b3_row8_col2" class="data row8 col2" >368.542627</td>
      <td id="T_626b3_row8_col3" class="data row8 col3" >0.159531</td>
    </tr>
  </tbody>
</table>

</div>
</div>
<div class="cell code" data-execution_count="157" id="NAu_o8ysWWJH">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>GS_best_models_2 <span class="op">=</span> {}</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="159"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:81}"
id="DjBAi6wQlcO8" data-outputId="2b456d29-d6ef-41ce-8a90-9a57eb492f59">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># лучшие параметры для модели Ridge</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>params_2 <span class="op">=</span> {</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;alpha&#39;</span>: <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">10</span><span class="op">**</span><span class="dv">6</span>, <span class="dv">5000</span>),</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;fit_intercept&#39;</span>: [<span class="va">True</span>, <span class="va">False</span>],</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;solver&#39;</span>: [<span class="st">&#39;auto&#39;</span>, <span class="st">&#39;svd&#39;</span>, <span class="st">&#39;cholesky&#39;</span>, <span class="st">&#39;lsqr&#39;</span>, <span class="st">&#39;sag&#39;</span>, <span class="st">&#39;saga&#39;</span>]</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>search, best_model <span class="op">=</span> grid_search(Ridge(), params_2, x2_train, y2_train)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Сохранение лучшей модели в словарь</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>GS_best_models_2[<span class="bu">str</span>(best_model)] <span class="op">=</span> best_model</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Вывод результатов для лучшей модели</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>search.loc[search[<span class="st">&#39;rank&#39;</span>] <span class="op">==</span> <span class="dv">1</span>, [<span class="st">&#39;best parameters&#39;</span>, <span class="st">&#39;RMSE&#39;</span>]]</span></code></pre></div>
<div class="output execute_result" data-execution_count="159">

  <div id="df-e4c3a723-624f-4afe-b592-78e00389c2a5" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>best parameters</th>
      <th>RMSE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2320</th>
      <td>{'alpha': 965001, 'fit_intercept': True, 'solver': 'sag'}</td>
      <td>448.544903</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e4c3a723-624f-4afe-b592-78e00389c2a5')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e4c3a723-624f-4afe-b592-78e00389c2a5 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e4c3a723-624f-4afe-b592-78e00389c2a5');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="160"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:81}"
id="zBEtnhQulcM4" data-outputId="a545d8b9-ff16-499e-c7b8-b3599fd8b75f">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># лучшие параметры для модели Lasso</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>params_2 <span class="op">=</span> {</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;alpha&#39;</span>: [<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>, <span class="fl">0.15</span>, <span class="fl">0.2</span>, <span class="fl">0.095</span>, <span class="dv">1</span>],</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;fit_intercept&#39;</span>: [<span class="va">True</span>, <span class="va">False</span>],</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>search, best_model <span class="op">=</span> grid_search(Lasso(), params_2, x2_train, y2_train)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Сохранение лучшей модели в словарь</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>GS_best_models_2[<span class="bu">str</span>(best_model)] <span class="op">=</span> best_model</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Вывод результатов для лучшей модели</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>search.loc[search[<span class="st">&#39;rank&#39;</span>] <span class="op">==</span> <span class="dv">1</span>, [<span class="st">&#39;best parameters&#39;</span>, <span class="st">&#39;RMSE&#39;</span>]]</span></code></pre></div>
<div class="output execute_result" data-execution_count="160">

  <div id="df-28c2d0e9-e7ba-49b0-8c39-879a2ad44d00" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>best parameters</th>
      <th>RMSE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>14</th>
      <td>{'alpha': 1, 'fit_intercept': True}</td>
      <td>454.589948</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-28c2d0e9-e7ba-49b0-8c39-879a2ad44d00')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-28c2d0e9-e7ba-49b0-8c39-879a2ad44d00 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-28c2d0e9-e7ba-49b0-8c39-879a2ad44d00');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="161"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:81}"
id="8y77AHSblcEy" data-outputId="27ce1146-0240-4075-ebc5-10213d61e79f">
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># лучшие параметры для модели градиентного бустинга</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>params_2 <span class="op">=</span> {</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;n_estimators&#39;</span>: [<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">25</span>],</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;learning_rate&#39;</span>: [<span class="fl">0.05</span>, <span class="fl">0.2</span>],</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;max_depth&#39;</span>: [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>],</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;min_samples_split&#39;</span>: [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">7</span>],</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;min_samples_leaf&#39;</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>],</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;subsample&#39;</span>: [<span class="fl">0.5</span>, <span class="fl">1.0</span>]</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>search, best_model <span class="op">=</span> grid_search(GradientBoostingRegressor(), params_2, x2_train, y2_train)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Сохранение лучшей модели в словарь</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>GS_best_models_2[<span class="bu">str</span>(best_model)] <span class="op">=</span> best_model</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Вывод результатов для лучшей модели</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>search.loc[search[<span class="st">&#39;rank&#39;</span>] <span class="op">==</span> <span class="dv">1</span>, [<span class="st">&#39;best parameters&#39;</span>, <span class="st">&#39;RMSE&#39;</span>]]</span></code></pre></div>
<div class="output execute_result" data-execution_count="161">

  <div id="df-08e7a0aa-01a0-417f-bd6f-5706d4b334d7" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>best parameters</th>
      <th>RMSE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>146</th>
      <td>{'learning_rate': 0.05, 'max_depth': 5, 'min_samples_leaf': 4, 'min_samples_split': 2, 'n_estima...</td>
      <td>447.244281</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-08e7a0aa-01a0-417f-bd6f-5706d4b334d7')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-08e7a0aa-01a0-417f-bd6f-5706d4b334d7 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-08e7a0aa-01a0-417f-bd6f-5706d4b334d7');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="162"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:81}"
id="y4TZKB-YlcCk" data-outputId="ae1e0326-34ca-41ff-ab1a-a62dd8a65680">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># лучшие параметры для метода опорных векторов</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>params_2 <span class="op">=</span> {</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;C&#39;</span>: [<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>],</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;kernel&#39;</span>: [<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;rbf&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;sigmoid&#39;</span>]</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>search, best_model <span class="op">=</span> grid_search(SVR(), params_2, x2_train, y2_train)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Сохранение лучшей модели в словарь</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>GS_best_models_2[<span class="bu">str</span>(best_model)] <span class="op">=</span> best_model</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Вывод результатов для лучшей модели</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>search.loc[search[<span class="st">&#39;rank&#39;</span>] <span class="op">==</span> <span class="dv">1</span>, [<span class="st">&#39;best parameters&#39;</span>, <span class="st">&#39;RMSE&#39;</span>]]</span></code></pre></div>
<div class="output execute_result" data-execution_count="162">

  <div id="df-7b175a19-cbe1-4101-add5-c4c394ba3f10" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>best parameters</th>
      <th>RMSE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>{'C': 0.001, 'kernel': 'poly'}</td>
      <td>448.422906</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-7b175a19-cbe1-4101-add5-c4c394ba3f10')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-7b175a19-cbe1-4101-add5-c4c394ba3f10 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-7b175a19-cbe1-4101-add5-c4c394ba3f10');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="163"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:81}"
id="h-AZc_VBlcAS" data-outputId="da220667-39e3-486d-e13b-5b892e77f804">
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># лучшие параметры для KNN</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>params_2 <span class="op">=</span> {</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;n_neighbors&#39;</span>: [<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>],</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;weights&#39;</span>: [<span class="st">&#39;uniform&#39;</span>, <span class="st">&#39;distance&#39;</span>],</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;metric&#39;</span>: [<span class="st">&#39;euclidean&#39;</span>, <span class="st">&#39;manhattan&#39;</span>, <span class="st">&#39;minkowski&#39;</span>, <span class="st">&#39;chebyshev&#39;</span>],</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>search, best_model <span class="op">=</span> grid_search(KNeighborsRegressor(), params_2, x2_train, y2_train)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Сохранение лучшей модели в словарь</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>GS_best_models_2[<span class="bu">str</span>(best_model)] <span class="op">=</span> best_model</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Вывод результатов для лучшей модели</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>search.loc[search[<span class="st">&#39;rank&#39;</span>] <span class="op">==</span> <span class="dv">1</span>, [<span class="st">&#39;best parameters&#39;</span>, <span class="st">&#39;RMSE&#39;</span>]]</span></code></pre></div>
<div class="output execute_result" data-execution_count="163">

  <div id="df-a7ec2670-893a-436e-bcdc-2e501413e8e4" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>best parameters</th>
      <th>RMSE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>15</th>
      <td>{'metric': 'manhattan', 'n_neighbors': 9, 'weights': 'distance'}</td>
      <td>462.713249</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a7ec2670-893a-436e-bcdc-2e501413e8e4')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a7ec2670-893a-436e-bcdc-2e501413e8e4 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a7ec2670-893a-436e-bcdc-2e501413e8e4');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="164"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:81}"
id="L9tHNhrDlb-A" data-outputId="f41f7eb7-3355-4893-8e07-dbac0ec98131">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># лучшие параметры для Decision Tree</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>params_2 <span class="op">=</span> {</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;max_depth&#39;</span>: [<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">10</span>],</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;min_samples_split&#39;</span>: [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>],</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;min_samples_leaf&#39;</span>: [<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>],</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;criterion&#39;</span>: [<span class="st">&#39;squared_error&#39;</span>, <span class="st">&#39;absolute_error&#39;</span>, <span class="st">&#39;friedman_mse&#39;</span>]</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>search, best_model <span class="op">=</span> grid_search(DecisionTreeRegressor(), params_2, x2_train, y2_train)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Сохранение лучшей модели в словарь</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>GS_best_models_2[<span class="bu">str</span>(best_model)] <span class="op">=</span> best_model</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Вывод результатов для лучшей модели</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>search.loc[search[<span class="st">&#39;rank&#39;</span>] <span class="op">==</span> <span class="dv">1</span>, [<span class="st">&#39;best parameters&#39;</span>, <span class="st">&#39;RMSE&#39;</span>]]</span></code></pre></div>
<div class="output execute_result" data-execution_count="164">

  <div id="df-e5cb8ba6-54dd-428c-a355-3767ca1d3f1c" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>best parameters</th>
      <th>RMSE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>27</th>
      <td>{'criterion': 'absolute_error', 'max_depth': 3, 'min_samples_leaf': 1, 'min_samples_split': 2}</td>
      <td>455.142335</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e5cb8ba6-54dd-428c-a355-3767ca1d3f1c')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e5cb8ba6-54dd-428c-a355-3767ca1d3f1c button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e5cb8ba6-54dd-428c-a355-3767ca1d3f1c');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="165"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:81}"
id="4EacJjLjlb7n" data-outputId="1f0ed8a4-7f05-4ad6-8559-04daa3c6a0c5">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># лучшие параметры для Random Forest</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>params_2 <span class="op">=</span> {</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;n_estimators&#39;</span>: [<span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">10</span>],</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;max_depth&#39;</span>: [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">6</span>],</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;min_samples_split&#39;</span>: [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">7</span>],</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;min_samples_leaf&#39;</span>: [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">7</span>],</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;criterion&#39;</span>: [<span class="st">&#39;squared_error&#39;</span>, <span class="st">&#39;absolute_error&#39;</span>],</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;bootstrap&#39;</span>: [<span class="va">True</span>, <span class="va">False</span>]</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>search, best_model <span class="op">=</span> grid_search(RandomForestRegressor(), params_2, x2_train, y2_train)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Сохранение лучшей модели в словарь</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>GS_best_models_2[<span class="bu">str</span>(best_model)] <span class="op">=</span> best_model</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Вывод результатов для лучшей модели</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>search.loc[search[<span class="st">&#39;rank&#39;</span>] <span class="op">==</span> <span class="dv">1</span>, [<span class="st">&#39;best parameters&#39;</span>, <span class="st">&#39;RMSE&#39;</span>]]</span></code></pre></div>
<div class="output execute_result" data-execution_count="165">

  <div id="df-41e53fc8-a21c-4a75-91f0-0092948f04ee" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>best parameters</th>
      <th>RMSE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>94</th>
      <td>{'bootstrap': True, 'criterion': 'absolute_error', 'max_depth': 3, 'min_samples_leaf': 5, 'min_s...</td>
      <td>449.92098</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-41e53fc8-a21c-4a75-91f0-0092948f04ee')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-41e53fc8-a21c-4a75-91f0-0092948f04ee button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-41e53fc8-a21c-4a75-91f0-0092948f04ee');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="166"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:269}"
id="vm-1wpBemwAs" data-outputId="f2f2532e-ab6d-4da2-8d86-e40fb35686e0">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>mod_results_2 <span class="op">=</span> evaluate_models(GS_best_models_2, x2_train, y2_train)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>styled_mod_results_2 <span class="op">=</span> style_model_results(mod_results_2)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>styled_mod_results_2</span></code></pre></div>
<div class="output execute_result" data-execution_count="166">
<style type="text/css">
#T_cb2c6_row0_col2, #T_cb2c6_row3_col0, #T_cb2c6_row3_col1, #T_cb2c6_row3_col3 {
  background-color: green;
}
#T_cb2c6_row4_col0, #T_cb2c6_row4_col1, #T_cb2c6_row4_col2, #T_cb2c6_row4_col3 {
  background-color: blue;
}
</style>
<table id="T_cb2c6" class="dataframe">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_cb2c6_level0_col0" class="col_heading level0 col0" >R2</th>
      <th id="T_cb2c6_level0_col1" class="col_heading level0 col1" >RMSE</th>
      <th id="T_cb2c6_level0_col2" class="col_heading level0 col2" >MAE</th>
      <th id="T_cb2c6_level0_col3" class="col_heading level0 col3" >MAPE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_cb2c6_level0_row0" class="row_heading level0 row0" >Ridge(alpha=965001, solver='sag')</th>
      <td id="T_cb2c6_row0_col0" class="data row0 col0" >-0.008785</td>
      <td id="T_cb2c6_row0_col1" class="data row0 col1" >448.545071</td>
      <td id="T_cb2c6_row0_col2" class="data row0 col2" >358.490865</td>
      <td id="T_cb2c6_row0_col3" class="data row0 col3" >0.155329</td>
    </tr>
    <tr>
      <th id="T_cb2c6_level0_row1" class="row_heading level0 row1" >Lasso(alpha=1)</th>
      <td id="T_cb2c6_row1_col0" class="data row1 col0" >-0.035833</td>
      <td id="T_cb2c6_row1_col1" class="data row1 col1" >454.589948</td>
      <td id="T_cb2c6_row1_col2" class="data row1 col2" >363.969117</td>
      <td id="T_cb2c6_row1_col3" class="data row1 col3" >0.157269</td>
    </tr>
    <tr>
      <th id="T_cb2c6_level0_row2" class="row_heading level0 row2" >GradientBoostingRegressor(learning_rate=0.05, max_depth=5, min_samples_leaf=4,
                          n_estimators=10, subsample=0.5)</th>
      <td id="T_cb2c6_row2_col0" class="data row2 col0" >-0.022137</td>
      <td id="T_cb2c6_row2_col1" class="data row2 col1" >451.590232</td>
      <td id="T_cb2c6_row2_col2" class="data row2 col2" >361.238178</td>
      <td id="T_cb2c6_row2_col3" class="data row2 col3" >0.156259</td>
    </tr>
    <tr>
      <th id="T_cb2c6_level0_row3" class="row_heading level0 row3" >SVR(C=0.001, kernel='poly')</th>
      <td id="T_cb2c6_row3_col0" class="data row3 col0" >-0.008242</td>
      <td id="T_cb2c6_row3_col1" class="data row3 col1" >448.422906</td>
      <td id="T_cb2c6_row3_col2" class="data row3 col2" >358.590912</td>
      <td id="T_cb2c6_row3_col3" class="data row3 col3" >0.155206</td>
    </tr>
    <tr>
      <th id="T_cb2c6_level0_row4" class="row_heading level0 row4" >KNeighborsRegressor(metric='manhattan', n_neighbors=9, weights='distance')</th>
      <td id="T_cb2c6_row4_col0" class="data row4 col0" >-0.073862</td>
      <td id="T_cb2c6_row4_col1" class="data row4 col1" >462.713249</td>
      <td id="T_cb2c6_row4_col2" class="data row4 col2" >368.924407</td>
      <td id="T_cb2c6_row4_col3" class="data row4 col3" >0.160108</td>
    </tr>
    <tr>
      <th id="T_cb2c6_level0_row5" class="row_heading level0 row5" >DecisionTreeRegressor(criterion='absolute_error', max_depth=3)</th>
      <td id="T_cb2c6_row5_col0" class="data row5 col0" >-0.039571</td>
      <td id="T_cb2c6_row5_col1" class="data row5 col1" >455.157097</td>
      <td id="T_cb2c6_row5_col2" class="data row5 col2" >361.302806</td>
      <td id="T_cb2c6_row5_col3" class="data row5 col3" >0.156037</td>
    </tr>
    <tr>
      <th id="T_cb2c6_level0_row6" class="row_heading level0 row6" >RandomForestRegressor(criterion='absolute_error', max_depth=3,
                      min_samples_leaf=5, min_samples_split=5, n_estimators=8)</th>
      <td id="T_cb2c6_row6_col0" class="data row6 col0" >-0.019548</td>
      <td id="T_cb2c6_row6_col1" class="data row6 col1" >450.786365</td>
      <td id="T_cb2c6_row6_col2" class="data row6 col2" >360.467414</td>
      <td id="T_cb2c6_row6_col3" class="data row6 col3" >0.155587</td>
    </tr>
  </tbody>
</table>

</div>
</div>
<div class="cell code" data-execution_count="167" id="YZ2ivVa6RUPb">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>best_model_2 <span class="op">=</span> GradientBoostingRegressor(</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>     n_estimators <span class="op">=</span> <span class="dv">5</span>,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>     learning_rate <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>     min_samples_split <span class="op">=</span> <span class="dv">7</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>     min_samples_leaf <span class="op">=</span> <span class="dv">4</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>     subsample <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>     max_depth <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>best_model_2.fit(x2_train, y2_train)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>y2_best <span class="op">=</span> best_model_2.predict(x2_test)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="169" id="FkeGBkoGnMHR">
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>base_model_2 <span class="op">=</span> DummyRegressor(strategy<span class="op">=</span><span class="st">&#39;mean&#39;</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>base_model_2.fit(x2_train, y2_train)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>y2_dummy_predicted <span class="op">=</span> base_model_2.predict(x2_test)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="170"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:112}"
id="oIyaSmXfnOIG" data-outputId="3d0c2831-b68a-471a-f5c2-2607048a6e64">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>diff_stats_2 <span class="op">=</span> calculate_metrics(<span class="st">&#39;Базовая модель&#39;</span>, y2_test, y2_dummy_predicted)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>diff_stats_2 <span class="op">=</span> pd.concat([diff_stats_2, calculate_metrics(<span class="st">&#39;Лучшая модель (GradientBoostingRegressor)&#39;</span>, y2_test, y2_best)], ignore_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>styled_diff_stats_2 <span class="op">=</span> style_model_results(diff_stats_2)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>styled_diff_stats_2</span></code></pre></div>
<div class="output execute_result" data-execution_count="170">
<style type="text/css">
#T_47373_row0_col0, #T_47373_row0_col1, #T_47373_row0_col2, #T_47373_row0_col3 {
  background-color: green;
}
#T_47373_row1_col0, #T_47373_row1_col1, #T_47373_row1_col2, #T_47373_row1_col3 {
  background-color: blue;
}
</style>
<table id="T_47373" class="dataframe">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_47373_level0_col0" class="col_heading level0 col0" >R2</th>
      <th id="T_47373_level0_col1" class="col_heading level0 col1" >RMSE</th>
      <th id="T_47373_level0_col2" class="col_heading level0 col2" >MAE</th>
      <th id="T_47373_level0_col3" class="col_heading level0 col3" >MAPE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_47373_level0_row0" class="row_heading level0 row0" >Базовая модель</th>
      <td id="T_47373_row0_col0" class="data row0 col0" >-0.000057</td>
      <td id="T_47373_row0_col1" class="data row0 col1" >462.664655</td>
      <td id="T_47373_row0_col2" class="data row0 col2" >368.866939</td>
      <td id="T_47373_row0_col3" class="data row0 col3" >0.161879</td>
    </tr>
    <tr>
      <th id="T_47373_level0_row1" class="row_heading level0 row1" >Лучшая модель (GradientBoostingRegressor)</th>
      <td id="T_47373_row1_col0" class="data row1 col0" >-0.001992</td>
      <td id="T_47373_row1_col1" class="data row1 col1" >463.112002</td>
      <td id="T_47373_row1_col2" class="data row1 col2" >369.709111</td>
      <td id="T_47373_row1_col3" class="data row1 col3" >0.162112</td>
    </tr>
  </tbody>
</table>

</div>
</div>
<section id="3ая-целевая-метрика---соотношение-матрица-наполнитель"
class="cell markdown" id="b-0o16nplUl4">
<h1>3ая целевая метрика - соотношение матрица-наполнитель</h1>
</section>
<div class="cell markdown" id="yxiDzTIHu8fX">
<p>В соответствии с заданием необходимо создать нейронную сеть,
рекомендующую значение данного параметра</p>
</div>
<div class="cell markdown" id="vHwECHZNxVJW">
<p>Многослойный перцептрон (MLPRegressor)</p>
</div>
<div class="cell code" data-execution_count="171" id="NYAkwwX8c-3x">
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>x3_train_initial, x3_test_initial, y3_train, y3_test <span class="op">=</span> train_test_split(x3, y3, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>y3_train <span class="op">=</span> y3_train[<span class="st">&#39;Соотношение матрица-наполнитель&#39;</span>].values</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>y3_test <span class="op">=</span> y3_test[<span class="st">&#39;Соотношение матрица-наполнитель&#39;</span>].values</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="172" id="w5Bg5rK3jpH7">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># препроцессинг</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>x3_train <span class="op">=</span> preproc_3.fit_transform(x3_train_initial)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>x3_test <span class="op">=</span> preproc_3.transform(x3_test_initial)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="173" id="bcKAfWHMlb0G">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>base_3 <span class="op">=</span> DummyRegressor(strategy<span class="op">=</span><span class="st">&#39;mean&#39;</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>base_3.fit(x3_train, y3_train)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>y3_dummy <span class="op">=</span> base_3.predict(x3_test)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="174"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="xXnlNvcSdSpH" data-outputId="7d48f984-e6a7-46e1-935c-0a0f97d4224a">
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># модель многослойного перцептрона</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>mlp <span class="op">=</span> MLPRegressor(</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>              hidden_layer_sizes <span class="op">=</span> (<span class="dv">64</span>, <span class="dv">64</span>, <span class="dv">32</span>, <span class="dv">32</span>, <span class="dv">16</span>, <span class="dv">16</span>, <span class="dv">8</span>, <span class="dv">8</span>),</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>              activation <span class="op">=</span> <span class="st">&#39;relu&#39;</span>,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>              solver<span class="op">=</span><span class="st">&#39;adam&#39;</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>              max_iter<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>              early_stopping <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>              validation_fraction <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>              alpha <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>              random_state<span class="op">=</span><span class="dv">42</span>,</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>              verbose<span class="op">=</span><span class="va">True</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>mlp.fit(x3_train, y3_train)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Iteration 1, loss = 2.41823665
Validation score: -4.263452
Iteration 2, loss = 2.31530279
Validation score: -4.071077
Iteration 3, loss = 2.22585977
Validation score: -3.905421
Iteration 4, loss = 2.15128538
Validation score: -3.762145
Iteration 5, loss = 2.08413654
Validation score: -3.617629
Iteration 6, loss = 2.01643330
Validation score: -3.466933
Iteration 7, loss = 1.94611261
Validation score: -3.308277
Iteration 8, loss = 1.87062280
Validation score: -3.134350
Iteration 9, loss = 1.78739864
Validation score: -2.931636
Iteration 10, loss = 1.69045346
Validation score: -2.696407
Iteration 11, loss = 1.57669273
Validation score: -2.402364
Iteration 12, loss = 1.42465538
Validation score: -2.004647
Iteration 13, loss = 1.22367835
Validation score: -1.492637
Iteration 14, loss = 0.97049443
Validation score: -0.912732
Iteration 15, loss = 0.70352198
Validation score: -0.374532
Iteration 16, loss = 0.48818570
Validation score: -0.104601
Iteration 17, loss = 0.42508194
Validation score: -0.231417
Iteration 18, loss = 0.53460988
Validation score: -0.275385
Iteration 19, loss = 0.52118999
Validation score: -0.119796
Iteration 20, loss = 0.43547794
Validation score: -0.067268
Iteration 21, loss = 0.40475830
Validation score: -0.106666
Iteration 22, loss = 0.41832892
Validation score: -0.146272
Iteration 23, loss = 0.42911370
Validation score: -0.140742
Iteration 24, loss = 0.42479935
Validation score: -0.109156
Iteration 25, loss = 0.41177170
Validation score: -0.071776
Iteration 26, loss = 0.39937786
Validation score: -0.047420
Iteration 27, loss = 0.39364543
Validation score: -0.038717
Iteration 28, loss = 0.39289768
Validation score: -0.036034
Iteration 29, loss = 0.39147768
Validation score: -0.033946
Iteration 30, loss = 0.38923823
Validation score: -0.036993
Iteration 31, loss = 0.38745475
Validation score: -0.038980
Iteration 32, loss = 0.38591056
Validation score: -0.036075
Iteration 33, loss = 0.38386348
Validation score: -0.032529
Iteration 34, loss = 0.38196134
Validation score: -0.027685
Iteration 35, loss = 0.38033069
Validation score: -0.023576
Iteration 36, loss = 0.37859476
Validation score: -0.020965
Iteration 37, loss = 0.37703754
Validation score: -0.018823
Iteration 38, loss = 0.37540084
Validation score: -0.016057
Iteration 39, loss = 0.37386906
Validation score: -0.013343
Iteration 40, loss = 0.37207805
Validation score: -0.011108
Iteration 41, loss = 0.37017951
Validation score: -0.011137
Iteration 42, loss = 0.36812397
Validation score: -0.012644
Iteration 43, loss = 0.36692260
Validation score: -0.013741
Iteration 44, loss = 0.36533988
Validation score: -0.012645
Iteration 45, loss = 0.36343956
Validation score: -0.012298
Iteration 46, loss = 0.36143893
Validation score: -0.010437
Iteration 47, loss = 0.35963912
Validation score: -0.008559
Iteration 48, loss = 0.35760581
Validation score: -0.007186
Iteration 49, loss = 0.35574341
Validation score: -0.005474
Iteration 50, loss = 0.35396031
Validation score: -0.004307
Iteration 51, loss = 0.35180062
Validation score: -0.006469
Iteration 52, loss = 0.34987852
Validation score: -0.006629
Iteration 53, loss = 0.34745860
Validation score: -0.005677
Iteration 54, loss = 0.34504148
Validation score: -0.004491
Iteration 55, loss = 0.34419874
Validation score: -0.003150
Iteration 56, loss = 0.34096079
Validation score: -0.002707
Iteration 57, loss = 0.33798985
Validation score: -0.004262
Iteration 58, loss = 0.33676487
Validation score: -0.005538
Iteration 59, loss = 0.33352566
Validation score: -0.002757
Iteration 60, loss = 0.33032784
Validation score: -0.000586
Iteration 61, loss = 0.32846042
Validation score: -0.000754
Iteration 62, loss = 0.32735544
Validation score: -0.001222
Iteration 63, loss = 0.32377308
Validation score: -0.001525
Iteration 64, loss = 0.31976098
Validation score: -0.000793
Iteration 65, loss = 0.31648210
Validation score: -0.004445
Iteration 66, loss = 0.31256649
Validation score: -0.004598
Iteration 67, loss = 0.30837146
Validation score: -0.006361
Iteration 68, loss = 0.30453927
Validation score: -0.011227
Iteration 69, loss = 0.30121934
Validation score: -0.015957
Iteration 70, loss = 0.29647647
Validation score: -0.030242
Iteration 71, loss = 0.29514424
Validation score: -0.027668
Validation score did not improve more than tol=0.000100 for 10 consecutive epochs. Stopping.
</code></pre>
</div>
<div class="output execute_result" data-execution_count="174">
<style>#sk-container-id-2 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: #000;
  --sklearn-color-text-muted: #666;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-2 {
  color: var(--sklearn-color-text);
}

#sk-container-id-2 pre {
  padding: 0;
}

#sk-container-id-2 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-2 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-2 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-2 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-2 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-2 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-2 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-2 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-2 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-2 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-2 label.sk-toggleable__label {
  cursor: pointer;
  display: flex;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
  align-items: start;
  justify-content: space-between;
  gap: 0.5em;
}

#sk-container-id-2 label.sk-toggleable__label .caption {
  font-size: 0.6rem;
  font-weight: lighter;
  color: var(--sklearn-color-text-muted);
}

#sk-container-id-2 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-2 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-2 div.sk-label label.sk-toggleable__label,
#sk-container-id-2 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-2 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-2 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-2 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-2 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-2 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 0.5em;
  text-align: center;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-2 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-2 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-2 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-2 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>MLPRegressor(alpha=0.01, early_stopping=True,
             hidden_layer_sizes=(64, 64, 32, 32, 16, 16, 8, 8), max_iter=1000,
             random_state=42, validation_fraction=0.3, verbose=True)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked><label for="sk-estimator-id-2" class="sk-toggleable__label fitted sk-toggleable__label-arrow"><div><div>MLPRegressor</div></div><div><a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.6/modules/generated/sklearn.neural_network.MLPRegressor.html">?<span>Documentation for MLPRegressor</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></div></label><div class="sk-toggleable__content fitted"><pre>MLPRegressor(alpha=0.01, early_stopping=True,
             hidden_layer_sizes=(64, 64, 32, 32, 16, 16, 8, 8), max_iter=1000,
             random_state=42, validation_fraction=0.3, verbose=True)</pre></div> </div></div></div></div>
</div>
</div>
<div class="cell code" data-execution_count="175"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:699}"
id="3LwzakARojG2" data-outputId="43e4617a-209e-4819-ad68-5be455dfc158">
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>y3_pred_skl <span class="op">=</span> mlp.predict(x3_test)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">8</span>))</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>ax.plot(y3_test, color <span class="op">=</span> <span class="st">&#39;yellow&#39;</span>, label<span class="op">=</span><span class="st">&#39;Данные&#39;</span>)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>ax.plot(y3_pred_skl, color <span class="op">=</span> <span class="st">&#39;red&#39;</span>, label<span class="op">=</span><span class="st">&#39;Прогнозная модель&#39;</span>)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>ax.plot(y3_dummy, label<span class="op">=</span><span class="st">&#39;Базовая модель&#39;</span>)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Результат работы модели многослойного перцептрона&#39;</span>)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_823183e1f35445208756c956c399aa02/9adf276ade6b25d239ce77ee80f8d91c0eb2bf78.png" /></p>
</div>
</div>
<div class="cell code" id="-Q5qA3zjBD4Y">
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>diff_mlp <span class="op">=</span> pd.DataFrame()</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>dummy_3 <span class="op">=</span> calculate_metrics(<span class="st">&quot;Dummy Regressor&quot;</span>, y3_test, y3_dummy)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>diff_mlp <span class="op">=</span> pd.concat([diff_mlp, dummy_3], ignore_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>mlp_metrics <span class="op">=</span> calculate_metrics(<span class="st">&quot;MLPRegressor&quot;</span>, y3_test, y3_pred_skl)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>diff_mlp <span class="op">=</span> pd.concat([diff_mlp, mlp_metrics], ignore_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>styled_diff_mlp <span class="op">=</span> style_model_results(diff_mlp)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>styled_diff_mlp</span></code></pre></div>
</div>
<div class="cell markdown" id="Ned7kH6nx3zJ">
<p>Нейронная сеть на TensorFlow</p>
</div>
<div class="cell code" data-execution_count="176" id="_MvPOorlvw_V">
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создаем аналогичную архитектуру нейросети</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> keras_model():</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tf.keras.Sequential([</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>      keras.layers.Input(shape<span class="op">=</span>(<span class="dv">12</span>,), name<span class="op">=</span><span class="st">&#39;in&#39;</span>),                      <span class="co"># 12 признаков</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>      keras.layers.Dense(<span class="dv">64</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>, name<span class="op">=</span><span class="st">&#39;dense_1&#39;</span>),</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>      keras.layers.Dense(<span class="dv">64</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>, name<span class="op">=</span><span class="st">&#39;dense_2&#39;</span>),</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>      keras.layers.Dense(<span class="dv">32</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>, name<span class="op">=</span><span class="st">&#39;dense_3&#39;</span>),</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>      keras.layers.Dense(<span class="dv">32</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>, name<span class="op">=</span><span class="st">&#39;dense_4&#39;</span>),</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>      keras.layers.Dense(<span class="dv">16</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>, name<span class="op">=</span><span class="st">&#39;dense_5&#39;</span>),</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>      keras.layers.Dense(<span class="dv">16</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>, name<span class="op">=</span><span class="st">&#39;dense_6&#39;</span>),</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>      keras.layers.Dense(<span class="dv">8</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>, name<span class="op">=</span><span class="st">&#39;dense_7&#39;</span>),</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>      keras.layers.Dense(<span class="dv">8</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>, name<span class="op">=</span><span class="st">&#39;dense_8&#39;</span>),</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>      keras.layers.Dense(<span class="dv">1</span>, name<span class="op">=</span><span class="st">&#39;out&#39;</span>)</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>    ])</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="177" id="Se7BthD2pULz">
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compile_model(model):</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    model.<span class="bu">compile</span>(</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>      optimizer<span class="op">=</span>keras.optimizers.Adam(</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>            learning_rate<span class="op">=</span><span class="fl">0.01</span>,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>      loss<span class="op">=</span>keras.losses.MeanAbsolutePercentageError(),</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>      metrics<span class="op">=</span>[<span class="st">&#39;mae&#39;</span>, <span class="st">&#39;mape&#39;</span>, <span class="st">&#39;root_mean_squared_error&#39;</span>]</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="178" id="gVhgAGGbvit5">
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># визуализация графиков ошибок</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_nn_loss(history):</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">5</span>))  <span class="co"># 3 графика в 1 ряду</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># MAPE</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot(history.history[<span class="st">&#39;loss&#39;</span>], label<span class="op">=</span><span class="st">&#39;train_loss (MAPE)&#39;</span>, color<span class="op">=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot(history.history[<span class="st">&#39;val_loss&#39;</span>], label<span class="op">=</span><span class="st">&#39;val_loss (MAPE)&#39;</span>, color<span class="op">=</span><span class="st">&#39;orange&#39;</span>)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xlabel(<span class="st">&#39;Эпоха&#39;</span>)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].legend()</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_title(<span class="st">&#39;График MAPE&#39;</span>)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].grid(<span class="va">True</span>)</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># RMSE</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(history.history[<span class="st">&#39;root_mean_squared_error&#39;</span>], label<span class="op">=</span><span class="st">&#39;train_loss (RMSE)&#39;</span>, color<span class="op">=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(history.history[<span class="st">&#39;val_root_mean_squared_error&#39;</span>], label<span class="op">=</span><span class="st">&#39;val_loss (RMSE)&#39;</span>, color<span class="op">=</span><span class="st">&#39;orange&#39;</span>)</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xlabel(<span class="st">&#39;Эпоха&#39;</span>)</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].legend()</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_title(<span class="st">&#39;График RMSE&#39;</span>)</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].grid(<span class="va">True</span>)</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># MAE</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].plot(history.history[<span class="st">&#39;mae&#39;</span>], label<span class="op">=</span><span class="st">&#39;train_loss (MAE)&#39;</span>, color<span class="op">=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].plot(history.history[<span class="st">&#39;val_mae&#39;</span>], label<span class="op">=</span><span class="st">&#39;val_loss (MAE)&#39;</span>, color<span class="op">=</span><span class="st">&#39;orange&#39;</span>)</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].set_xlabel(<span class="st">&#39;Эпоха&#39;</span>)</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].legend()</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].set_title(<span class="st">&#39;График MAE&#39;</span>)</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].grid(<span class="va">True</span>)</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="179"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:442}"
id="W2sN22MypYdo" data-outputId="9da80002-08d4-49c9-b7d3-289adf638d9a">
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>model_NN <span class="op">=</span> keras_model()</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>model_NN <span class="op">=</span> compile_model(model_NN) <span class="co"># компиляция нейросети</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>model_NN.summary()</span></code></pre></div>
<div class="output display_data">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">Model: "sequential_2"</span>
</pre>

</div>
<div class="output display_data">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> Layer (type)                         </span>┃<span style="font-weight: bold"> Output Shape                </span>┃<span style="font-weight: bold">         Param # </span>┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ dense_1 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                      │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">64</span>)                  │             <span style="color: #00af00; text-decoration-color: #00af00">832</span> │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_2 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                      │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">64</span>)                  │           <span style="color: #00af00; text-decoration-color: #00af00">4,160</span> │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_3 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                      │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">32</span>)                  │           <span style="color: #00af00; text-decoration-color: #00af00">2,080</span> │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_4 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                      │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">32</span>)                  │           <span style="color: #00af00; text-decoration-color: #00af00">1,056</span> │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_5 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                      │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">16</span>)                  │             <span style="color: #00af00; text-decoration-color: #00af00">528</span> │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_6 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                      │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">16</span>)                  │             <span style="color: #00af00; text-decoration-color: #00af00">272</span> │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_7 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                      │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">8</span>)                   │             <span style="color: #00af00; text-decoration-color: #00af00">136</span> │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_8 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                      │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">8</span>)                   │              <span style="color: #00af00; text-decoration-color: #00af00">72</span> │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ out (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                          │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">1</span>)                   │               <span style="color: #00af00; text-decoration-color: #00af00">9</span> │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
</pre>

</div>
<div class="output display_data">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Total params: </span><span style="color: #00af00; text-decoration-color: #00af00">9,145</span> (35.72 KB)
</pre>

</div>
<div class="output display_data">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">9,145</span> (35.72 KB)
</pre>

</div>
<div class="output display_data">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Non-trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">0</span> (0.00 B)
</pre>

</div>
</div>
<div class="cell code" data-execution_count="180"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="QKWNURb8W_jJ" data-outputId="95fda75b-aa25-4c91-aab4-60b1a2cfeb1b">
<div class="sourceCode" id="cb53"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>model_NN_hist <span class="op">=</span> model_NN.fit(</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>    x3_train,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    y3_train,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    epochs <span class="op">=</span> <span class="dv">100</span>,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    validation_split <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    verbose <span class="op">=</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Epoch 1/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 2s 20ms/step - loss: 95.5636 - mae: 2.8360 - mape: 95.5636 - root_mean_squared_error: 2.9803 - val_loss: 33.4639 - val_mae: 0.8572 - val_mape: 33.4639 - val_root_mean_squared_error: 1.0883
Epoch 2/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 36.2331 - mae: 0.9636 - mape: 36.2331 - root_mean_squared_error: 1.1910 - val_loss: 36.9022 - val_mae: 0.8009 - val_mape: 36.9022 - val_root_mean_squared_error: 1.0186
Epoch 3/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 28.3675 - mae: 0.8305 - mape: 28.3675 - root_mean_squared_error: 1.0461 - val_loss: 36.2600 - val_mae: 0.8004 - val_mape: 36.2600 - val_root_mean_squared_error: 1.0236
Epoch 4/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 28.9705 - mae: 0.7895 - mape: 28.9705 - root_mean_squared_error: 0.9823 - val_loss: 33.2460 - val_mae: 0.7851 - val_mape: 33.2460 - val_root_mean_squared_error: 1.0064
Epoch 5/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 26.7624 - mae: 0.7577 - mape: 26.7624 - root_mean_squared_error: 0.9494 - val_loss: 32.6962 - val_mae: 0.8014 - val_mape: 32.6962 - val_root_mean_squared_error: 1.0143
Epoch 6/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step - loss: 26.4231 - mae: 0.7690 - mape: 26.4231 - root_mean_squared_error: 0.9716 - val_loss: 32.4349 - val_mae: 0.8345 - val_mape: 32.4349 - val_root_mean_squared_error: 1.0507
Epoch 7/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 27.0862 - mae: 0.7393 - mape: 27.0862 - root_mean_squared_error: 0.9458 - val_loss: 33.2317 - val_mae: 0.8037 - val_mape: 33.2317 - val_root_mean_squared_error: 1.0191
Epoch 8/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 27.6154 - mae: 0.7666 - mape: 27.6154 - root_mean_squared_error: 0.9563 - val_loss: 33.0496 - val_mae: 0.8572 - val_mape: 33.0496 - val_root_mean_squared_error: 1.0674
Epoch 9/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 25.2396 - mae: 0.7191 - mape: 25.2396 - root_mean_squared_error: 0.9247 - val_loss: 32.8048 - val_mae: 0.8293 - val_mape: 32.8048 - val_root_mean_squared_error: 1.0355
Epoch 10/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 25.2856 - mae: 0.6976 - mape: 25.2856 - root_mean_squared_error: 0.8939 - val_loss: 33.3526 - val_mae: 0.8023 - val_mape: 33.3526 - val_root_mean_squared_error: 0.9963
Epoch 11/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 25.2971 - mae: 0.7274 - mape: 25.2971 - root_mean_squared_error: 0.9447 - val_loss: 33.5111 - val_mae: 0.8435 - val_mape: 33.5111 - val_root_mean_squared_error: 1.0478
Epoch 12/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 25.9744 - mae: 0.7594 - mape: 25.9744 - root_mean_squared_error: 0.9815 - val_loss: 33.5601 - val_mae: 0.8416 - val_mape: 33.5601 - val_root_mean_squared_error: 1.0487
Epoch 13/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step - loss: 26.8045 - mae: 0.7777 - mape: 26.8045 - root_mean_squared_error: 0.9766 - val_loss: 37.1431 - val_mae: 0.8239 - val_mape: 37.1431 - val_root_mean_squared_error: 1.0371
Epoch 14/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 26.6768 - mae: 0.7023 - mape: 26.6768 - root_mean_squared_error: 0.8759 - val_loss: 33.6854 - val_mae: 0.8356 - val_mape: 33.6854 - val_root_mean_squared_error: 1.0350
Epoch 15/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 23.9689 - mae: 0.7007 - mape: 23.9689 - root_mean_squared_error: 0.9028 - val_loss: 34.7943 - val_mae: 0.8242 - val_mape: 34.7943 - val_root_mean_squared_error: 1.0213
Epoch 16/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 26.6186 - mae: 0.7301 - mape: 26.6186 - root_mean_squared_error: 0.9171 - val_loss: 33.9516 - val_mae: 0.8435 - val_mape: 33.9516 - val_root_mean_squared_error: 1.0343
Epoch 17/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 24.8719 - mae: 0.7196 - mape: 24.8719 - root_mean_squared_error: 0.9341 - val_loss: 33.5535 - val_mae: 0.8838 - val_mape: 33.5535 - val_root_mean_squared_error: 1.0849
Epoch 18/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 23.5370 - mae: 0.6908 - mape: 23.5370 - root_mean_squared_error: 0.9041 - val_loss: 33.6994 - val_mae: 0.8410 - val_mape: 33.6994 - val_root_mean_squared_error: 1.0351
Epoch 19/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 23.4016 - mae: 0.6797 - mape: 23.4016 - root_mean_squared_error: 0.8872 - val_loss: 33.3635 - val_mae: 0.8641 - val_mape: 33.3635 - val_root_mean_squared_error: 1.0660
Epoch 20/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 22.3165 - mae: 0.6696 - mape: 22.3165 - root_mean_squared_error: 0.8933 - val_loss: 34.2407 - val_mae: 0.8864 - val_mape: 34.2407 - val_root_mean_squared_error: 1.0824
Epoch 21/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 22.1014 - mae: 0.6146 - mape: 22.1014 - root_mean_squared_error: 0.8106 - val_loss: 34.9694 - val_mae: 0.8582 - val_mape: 34.9694 - val_root_mean_squared_error: 1.0520
Epoch 22/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 22.2066 - mae: 0.6360 - mape: 22.2066 - root_mean_squared_error: 0.8336 - val_loss: 35.1442 - val_mae: 0.8921 - val_mape: 35.1442 - val_root_mean_squared_error: 1.0931
Epoch 23/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 22.5168 - mae: 0.6637 - mape: 22.5168 - root_mean_squared_error: 0.8811 - val_loss: 34.9410 - val_mae: 0.9391 - val_mape: 34.9410 - val_root_mean_squared_error: 1.1265
Epoch 24/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 23.1133 - mae: 0.6950 - mape: 23.1133 - root_mean_squared_error: 0.9085 - val_loss: 34.1053 - val_mae: 0.8598 - val_mape: 34.1053 - val_root_mean_squared_error: 1.0592
Epoch 25/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 22.4548 - mae: 0.6838 - mape: 22.4548 - root_mean_squared_error: 0.9191 - val_loss: 34.6578 - val_mae: 0.9536 - val_mape: 34.6578 - val_root_mean_squared_error: 1.1628
Epoch 26/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 21.3333 - mae: 0.6624 - mape: 21.3333 - root_mean_squared_error: 0.8908 - val_loss: 33.7395 - val_mae: 0.9033 - val_mape: 33.7395 - val_root_mean_squared_error: 1.1046
Epoch 27/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 20.5357 - mae: 0.6166 - mape: 20.5357 - root_mean_squared_error: 0.8358 - val_loss: 35.4197 - val_mae: 0.8908 - val_mape: 35.4197 - val_root_mean_squared_error: 1.1064
Epoch 28/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 21.0147 - mae: 0.6059 - mape: 21.0147 - root_mean_squared_error: 0.8276 - val_loss: 38.1417 - val_mae: 0.8601 - val_mape: 38.1417 - val_root_mean_squared_error: 1.0767
Epoch 29/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 21.1041 - mae: 0.6050 - mape: 21.1041 - root_mean_squared_error: 0.7871 - val_loss: 33.5269 - val_mae: 0.7908 - val_mape: 33.5269 - val_root_mean_squared_error: 0.9828
Epoch 30/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 11ms/step - loss: 19.8516 - mae: 0.5659 - mape: 19.8516 - root_mean_squared_error: 0.7652 - val_loss: 34.5083 - val_mae: 0.8759 - val_mape: 34.5083 - val_root_mean_squared_error: 1.0709
Epoch 31/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 18.2530 - mae: 0.5653 - mape: 18.2530 - root_mean_squared_error: 0.7838 - val_loss: 34.7497 - val_mae: 0.8441 - val_mape: 34.7497 - val_root_mean_squared_error: 1.0497
Epoch 32/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 21.1278 - mae: 0.6059 - mape: 21.1278 - root_mean_squared_error: 0.7990 - val_loss: 35.8556 - val_mae: 0.8252 - val_mape: 35.8556 - val_root_mean_squared_error: 1.0490
Epoch 33/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 20.9666 - mae: 0.5677 - mape: 20.9666 - root_mean_squared_error: 0.7356 - val_loss: 34.6794 - val_mae: 0.8283 - val_mape: 34.6794 - val_root_mean_squared_error: 1.0286
Epoch 34/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 17ms/step - loss: 17.9490 - mae: 0.5251 - mape: 17.9490 - root_mean_squared_error: 0.7042 - val_loss: 34.9339 - val_mae: 0.8747 - val_mape: 34.9339 - val_root_mean_squared_error: 1.0844
Epoch 35/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 16.9710 - mae: 0.5068 - mape: 16.9710 - root_mean_squared_error: 0.6950 - val_loss: 35.8793 - val_mae: 0.8856 - val_mape: 35.8793 - val_root_mean_squared_error: 1.1301
Epoch 36/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step - loss: 17.8124 - mae: 0.5348 - mape: 17.8124 - root_mean_squared_error: 0.7345 - val_loss: 35.7071 - val_mae: 0.8790 - val_mape: 35.7071 - val_root_mean_squared_error: 1.0826
Epoch 37/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 17.3193 - mae: 0.5260 - mape: 17.3193 - root_mean_squared_error: 0.7197 - val_loss: 35.9728 - val_mae: 0.8851 - val_mape: 35.9728 - val_root_mean_squared_error: 1.1237
Epoch 38/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 11ms/step - loss: 16.5096 - mae: 0.5045 - mape: 16.5096 - root_mean_squared_error: 0.7132 - val_loss: 34.7705 - val_mae: 0.8834 - val_mape: 34.7705 - val_root_mean_squared_error: 1.0970
Epoch 39/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 16.4377 - mae: 0.5213 - mape: 16.4377 - root_mean_squared_error: 0.7117 - val_loss: 34.5684 - val_mae: 0.8328 - val_mape: 34.5684 - val_root_mean_squared_error: 1.0549
Epoch 40/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 15.5010 - mae: 0.4707 - mape: 15.5010 - root_mean_squared_error: 0.6606 - val_loss: 38.0243 - val_mae: 0.9019 - val_mape: 38.0243 - val_root_mean_squared_error: 1.1517
Epoch 41/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 15.4145 - mae: 0.4425 - mape: 15.4145 - root_mean_squared_error: 0.6095 - val_loss: 35.0732 - val_mae: 0.8631 - val_mape: 35.0732 - val_root_mean_squared_error: 1.0903
Epoch 42/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 16.2528 - mae: 0.4904 - mape: 16.2528 - root_mean_squared_error: 0.6643 - val_loss: 35.0248 - val_mae: 0.8695 - val_mape: 35.0248 - val_root_mean_squared_error: 1.0865
Epoch 43/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 14.9301 - mae: 0.4567 - mape: 14.9301 - root_mean_squared_error: 0.6563 - val_loss: 35.4355 - val_mae: 0.8573 - val_mape: 35.4355 - val_root_mean_squared_error: 1.0754
Epoch 44/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 13.0362 - mae: 0.3995 - mape: 13.0362 - root_mean_squared_error: 0.5720 - val_loss: 36.3503 - val_mae: 0.9024 - val_mape: 36.3503 - val_root_mean_squared_error: 1.1168
Epoch 45/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 14.4076 - mae: 0.4467 - mape: 14.4076 - root_mean_squared_error: 0.6193 - val_loss: 34.7607 - val_mae: 0.8518 - val_mape: 34.7607 - val_root_mean_squared_error: 1.0669
Epoch 46/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 13.7231 - mae: 0.4186 - mape: 13.7231 - root_mean_squared_error: 0.5955 - val_loss: 37.0095 - val_mae: 0.8660 - val_mape: 37.0095 - val_root_mean_squared_error: 1.0946
Epoch 47/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 12.1785 - mae: 0.3588 - mape: 12.1785 - root_mean_squared_error: 0.5194 - val_loss: 36.6186 - val_mae: 0.9052 - val_mape: 36.6186 - val_root_mean_squared_error: 1.1260
Epoch 48/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 15.3178 - mae: 0.4886 - mape: 15.3178 - root_mean_squared_error: 0.6987 - val_loss: 38.3867 - val_mae: 0.8902 - val_mape: 38.3867 - val_root_mean_squared_error: 1.1046
Epoch 49/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 14.3944 - mae: 0.4157 - mape: 14.3944 - root_mean_squared_error: 0.5510 - val_loss: 36.1396 - val_mae: 0.9041 - val_mape: 36.1396 - val_root_mean_squared_error: 1.1402
Epoch 50/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 13.5498 - mae: 0.4008 - mape: 13.5498 - root_mean_squared_error: 0.5602 - val_loss: 35.1109 - val_mae: 0.8530 - val_mape: 35.1109 - val_root_mean_squared_error: 1.0595
Epoch 51/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 11ms/step - loss: 13.9457 - mae: 0.4157 - mape: 13.9457 - root_mean_squared_error: 0.5930 - val_loss: 37.9483 - val_mae: 0.8775 - val_mape: 37.9483 - val_root_mean_squared_error: 1.1245
Epoch 52/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 13.9203 - mae: 0.4114 - mape: 13.9203 - root_mean_squared_error: 0.5382 - val_loss: 36.3843 - val_mae: 0.8888 - val_mape: 36.3843 - val_root_mean_squared_error: 1.1129
Epoch 53/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 14.9545 - mae: 0.4709 - mape: 14.9545 - root_mean_squared_error: 0.6569 - val_loss: 36.4370 - val_mae: 0.9134 - val_mape: 36.4370 - val_root_mean_squared_error: 1.1380
Epoch 54/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 12.8218 - mae: 0.4027 - mape: 12.8218 - root_mean_squared_error: 0.5898 - val_loss: 40.0553 - val_mae: 0.9599 - val_mape: 40.0553 - val_root_mean_squared_error: 1.1931
Epoch 55/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 12.6213 - mae: 0.3854 - mape: 12.6213 - root_mean_squared_error: 0.5411 - val_loss: 35.2581 - val_mae: 0.8688 - val_mape: 35.2581 - val_root_mean_squared_error: 1.0986
Epoch 56/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 14.0617 - mae: 0.4211 - mape: 14.0617 - root_mean_squared_error: 0.5939 - val_loss: 38.9552 - val_mae: 0.8944 - val_mape: 38.9552 - val_root_mean_squared_error: 1.1390
Epoch 57/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 12.9777 - mae: 0.3968 - mape: 12.9777 - root_mean_squared_error: 0.5601 - val_loss: 38.0580 - val_mae: 0.9015 - val_mape: 38.0580 - val_root_mean_squared_error: 1.1303
Epoch 58/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step - loss: 12.7218 - mae: 0.3890 - mape: 12.7218 - root_mean_squared_error: 0.5618 - val_loss: 37.4063 - val_mae: 0.9185 - val_mape: 37.4063 - val_root_mean_squared_error: 1.1543
Epoch 59/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 12.5760 - mae: 0.3758 - mape: 12.5760 - root_mean_squared_error: 0.5540 - val_loss: 36.4197 - val_mae: 0.8731 - val_mape: 36.4197 - val_root_mean_squared_error: 1.1026
Epoch 60/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 11.4175 - mae: 0.3445 - mape: 11.4175 - root_mean_squared_error: 0.5030 - val_loss: 37.8534 - val_mae: 0.9588 - val_mape: 37.8534 - val_root_mean_squared_error: 1.1975
Epoch 61/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 16.0114 - mae: 0.4878 - mape: 16.0114 - root_mean_squared_error: 0.6642 - val_loss: 36.2760 - val_mae: 0.8630 - val_mape: 36.2760 - val_root_mean_squared_error: 1.1031
Epoch 62/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 12.2763 - mae: 0.3766 - mape: 12.2763 - root_mean_squared_error: 0.5531 - val_loss: 38.8264 - val_mae: 0.9226 - val_mape: 38.8264 - val_root_mean_squared_error: 1.1475
Epoch 63/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 11.4743 - mae: 0.3506 - mape: 11.4743 - root_mean_squared_error: 0.5041 - val_loss: 36.4012 - val_mae: 0.8966 - val_mape: 36.4012 - val_root_mean_squared_error: 1.1403
Epoch 64/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 10.7493 - mae: 0.3207 - mape: 10.7493 - root_mean_squared_error: 0.4613 - val_loss: 40.3046 - val_mae: 0.9088 - val_mape: 40.3046 - val_root_mean_squared_error: 1.1491
Epoch 65/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step - loss: 11.0777 - mae: 0.3412 - mape: 11.0777 - root_mean_squared_error: 0.4753 - val_loss: 37.0151 - val_mae: 0.8958 - val_mape: 37.0151 - val_root_mean_squared_error: 1.1409
Epoch 66/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 10.5304 - mae: 0.3178 - mape: 10.5304 - root_mean_squared_error: 0.4583 - val_loss: 44.8608 - val_mae: 0.9910 - val_mape: 44.8608 - val_root_mean_squared_error: 1.2377
Epoch 67/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 13.4216 - mae: 0.3917 - mape: 13.4216 - root_mean_squared_error: 0.5271 - val_loss: 37.9164 - val_mae: 0.9307 - val_mape: 37.9164 - val_root_mean_squared_error: 1.1802
Epoch 68/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 11.9828 - mae: 0.3551 - mape: 11.9828 - root_mean_squared_error: 0.4932 - val_loss: 37.8286 - val_mae: 0.8589 - val_mape: 37.8286 - val_root_mean_squared_error: 1.1077
Epoch 69/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 10.8216 - mae: 0.3084 - mape: 10.8216 - root_mean_squared_error: 0.4292 - val_loss: 37.9609 - val_mae: 0.9033 - val_mape: 37.9609 - val_root_mean_squared_error: 1.1658
Epoch 70/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 9.7379 - mae: 0.2930 - mape: 9.7379 - root_mean_squared_error: 0.4326 - val_loss: 38.8987 - val_mae: 0.8956 - val_mape: 38.8987 - val_root_mean_squared_error: 1.1373
Epoch 71/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 10.5250 - mae: 0.3070 - mape: 10.5250 - root_mean_squared_error: 0.4362 - val_loss: 39.4811 - val_mae: 0.9119 - val_mape: 39.4811 - val_root_mean_squared_error: 1.1748
Epoch 72/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 9.6636 - mae: 0.2821 - mape: 9.6636 - root_mean_squared_error: 0.4324 - val_loss: 37.5035 - val_mae: 0.8866 - val_mape: 37.5035 - val_root_mean_squared_error: 1.1436
Epoch 73/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 10.7302 - mae: 0.3211 - mape: 10.7302 - root_mean_squared_error: 0.4689 - val_loss: 38.2308 - val_mae: 0.9014 - val_mape: 38.2308 - val_root_mean_squared_error: 1.1471
Epoch 74/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 9.1532 - mae: 0.2666 - mape: 9.1532 - root_mean_squared_error: 0.3885 - val_loss: 38.3637 - val_mae: 0.8930 - val_mape: 38.3637 - val_root_mean_squared_error: 1.1329
Epoch 75/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step - loss: 8.7358 - mae: 0.2475 - mape: 8.7358 - root_mean_squared_error: 0.3621 - val_loss: 36.2560 - val_mae: 0.8492 - val_mape: 36.2560 - val_root_mean_squared_error: 1.0958
Epoch 76/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 13.1176 - mae: 0.3482 - mape: 13.1176 - root_mean_squared_error: 0.4978 - val_loss: 37.2419 - val_mae: 0.8868 - val_mape: 37.2419 - val_root_mean_squared_error: 1.1299
Epoch 77/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 10.9056 - mae: 0.3143 - mape: 10.9056 - root_mean_squared_error: 0.4550 - val_loss: 37.8056 - val_mae: 0.8688 - val_mape: 37.8056 - val_root_mean_squared_error: 1.1192
Epoch 78/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 11.7894 - mae: 0.3317 - mape: 11.7894 - root_mean_squared_error: 0.5309 - val_loss: 37.0270 - val_mae: 0.8871 - val_mape: 37.0270 - val_root_mean_squared_error: 1.1349
Epoch 79/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 10.9643 - mae: 0.3192 - mape: 10.9643 - root_mean_squared_error: 0.4856 - val_loss: 39.1899 - val_mae: 0.9301 - val_mape: 39.1899 - val_root_mean_squared_error: 1.1728
Epoch 80/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 10.7969 - mae: 0.3051 - mape: 10.7969 - root_mean_squared_error: 0.4496 - val_loss: 36.9815 - val_mae: 0.8941 - val_mape: 36.9815 - val_root_mean_squared_error: 1.1410
Epoch 81/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 12ms/step - loss: 9.9900 - mae: 0.2917 - mape: 9.9900 - root_mean_squared_error: 0.4319 - val_loss: 36.4823 - val_mae: 0.9163 - val_mape: 36.4823 - val_root_mean_squared_error: 1.1581
Epoch 82/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 11.0925 - mae: 0.3457 - mape: 11.0925 - root_mean_squared_error: 0.4953 - val_loss: 38.7897 - val_mae: 0.8810 - val_mape: 38.7897 - val_root_mean_squared_error: 1.1569
Epoch 83/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 10.3092 - mae: 0.3046 - mape: 10.3092 - root_mean_squared_error: 0.4563 - val_loss: 36.9485 - val_mae: 0.8781 - val_mape: 36.9485 - val_root_mean_squared_error: 1.1431
Epoch 84/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 8.4239 - mae: 0.2344 - mape: 8.4239 - root_mean_squared_error: 0.3657 - val_loss: 37.2757 - val_mae: 0.8660 - val_mape: 37.2757 - val_root_mean_squared_error: 1.1142
Epoch 85/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 8.0915 - mae: 0.2348 - mape: 8.0915 - root_mean_squared_error: 0.3475 - val_loss: 36.6211 - val_mae: 0.9141 - val_mape: 36.6211 - val_root_mean_squared_error: 1.1471
Epoch 86/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 10.4430 - mae: 0.3263 - mape: 10.4430 - root_mean_squared_error: 0.4537 - val_loss: 40.1186 - val_mae: 0.9285 - val_mape: 40.1186 - val_root_mean_squared_error: 1.1604
Epoch 87/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 12ms/step - loss: 9.6313 - mae: 0.2815 - mape: 9.6313 - root_mean_squared_error: 0.3915 - val_loss: 37.3852 - val_mae: 0.9124 - val_mape: 37.3852 - val_root_mean_squared_error: 1.1645
Epoch 88/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 9.8408 - mae: 0.2916 - mape: 9.8408 - root_mean_squared_error: 0.4174 - val_loss: 43.5088 - val_mae: 0.9634 - val_mape: 43.5088 - val_root_mean_squared_error: 1.2316
Epoch 89/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 11.5330 - mae: 0.3440 - mape: 11.5330 - root_mean_squared_error: 0.4573 - val_loss: 38.7607 - val_mae: 0.9161 - val_mape: 38.7607 - val_root_mean_squared_error: 1.1618
Epoch 90/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 11.1445 - mae: 0.3176 - mape: 11.1445 - root_mean_squared_error: 0.4423 - val_loss: 41.2235 - val_mae: 0.9145 - val_mape: 41.2235 - val_root_mean_squared_error: 1.1817
Epoch 91/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 9.4889 - mae: 0.2706 - mape: 9.4889 - root_mean_squared_error: 0.3679 - val_loss: 40.1097 - val_mae: 0.9275 - val_mape: 40.1097 - val_root_mean_squared_error: 1.2030
Epoch 92/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 8.9555 - mae: 0.2733 - mape: 8.9555 - root_mean_squared_error: 0.3929 - val_loss: 38.6250 - val_mae: 0.8812 - val_mape: 38.6250 - val_root_mean_squared_error: 1.1356
Epoch 93/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 8.8570 - mae: 0.2665 - mape: 8.8570 - root_mean_squared_error: 0.4008 - val_loss: 37.8359 - val_mae: 0.9106 - val_mape: 37.8359 - val_root_mean_squared_error: 1.1551
Epoch 94/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step - loss: 8.5829 - mae: 0.2479 - mape: 8.5829 - root_mean_squared_error: 0.3688 - val_loss: 37.5212 - val_mae: 0.8640 - val_mape: 37.5212 - val_root_mean_squared_error: 1.1154
Epoch 95/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step - loss: 9.3962 - mae: 0.2713 - mape: 9.3962 - root_mean_squared_error: 0.4057 - val_loss: 37.3353 - val_mae: 0.8708 - val_mape: 37.3353 - val_root_mean_squared_error: 1.1061
Epoch 96/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 9.1598 - mae: 0.2541 - mape: 9.1598 - root_mean_squared_error: 0.3790 - val_loss: 40.7900 - val_mae: 0.9315 - val_mape: 40.7900 - val_root_mean_squared_error: 1.2306
Epoch 97/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 8.4988 - mae: 0.2525 - mape: 8.4988 - root_mean_squared_error: 0.3730 - val_loss: 37.2183 - val_mae: 0.8835 - val_mape: 37.2183 - val_root_mean_squared_error: 1.1307
Epoch 98/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step - loss: 7.8484 - mae: 0.2362 - mape: 7.8484 - root_mean_squared_error: 0.3474 - val_loss: 38.9462 - val_mae: 0.8994 - val_mape: 38.9462 - val_root_mean_squared_error: 1.1704
Epoch 99/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 14ms/step - loss: 8.1256 - mae: 0.2220 - mape: 8.1256 - root_mean_squared_error: 0.3376 - val_loss: 39.1766 - val_mae: 0.9069 - val_mape: 39.1766 - val_root_mean_squared_error: 1.1668
Epoch 100/100
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step - loss: 7.7087 - mae: 0.2259 - mape: 7.7087 - root_mean_squared_error: 0.3385 - val_loss: 38.3827 - val_mae: 0.9209 - val_mape: 38.3827 - val_root_mean_squared_error: 1.1862
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="181"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:487}"
id="-KKFtG8Xs_GK" data-outputId="2299b5a9-d3ac-4513-cf68-aec5765c7767">
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>plot_nn_loss(model_NN_hist)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_823183e1f35445208756c956c399aa02/6e7f904deada4f4afe08bf778e87bf500bca1817.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="182"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:559}"
id="Y7yGR0fyxMOt" data-outputId="46c8a955-2066-4db1-f955-b52ebb740f59">
<div class="sourceCode" id="cb56"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>y3_NN_pred <span class="op">=</span> model_NN.predict(x3_test)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>plt.scatter(y3_test, y3_NN_pred, alpha<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">&quot;blue&quot;</span>, label<span class="op">=</span><span class="st">&quot;Предсказания&quot;</span>)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="bu">min</span>(y3_test), <span class="bu">max</span>(y3_test)], [<span class="bu">min</span>(y3_test), <span class="bu">max</span>(y3_test)], color<span class="op">=</span><span class="st">&quot;red&quot;</span>, linestyle<span class="op">=</span><span class="st">&quot;--&quot;</span>, label<span class="op">=</span><span class="st">&quot;Идеальная линия&quot;</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Истинные значения&quot;</span>)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Предсказанные значения&quot;</span>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>9/9 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_823183e1f35445208756c956c399aa02/ec5f0620cb4cb9589596d0318597197586627f56.png" /></p>
</div>
</div>
<div class="cell markdown" id="pJZLfBQE6vpD">
<p>Постараюсь улучшить модель посредством добавления колбэка, дропаута,
корректировки параметра коэффициента обучения и пакетной нормализации -
нормализации входных данных слоев нейронки</p>
</div>
<div class="cell code" data-execution_count="183" id="tXIR9GMg5aYa">
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.layers <span class="im">import</span> BatchNormalization</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.callbacks <span class="im">import</span> EarlyStopping</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> keras_model_2():</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> keras.Sequential([</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>        keras.layers.Input(shape<span class="op">=</span>(<span class="dv">12</span>,), name<span class="op">=</span><span class="st">&#39;in&#39;</span>),</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>        keras.layers.Dense(<span class="dv">64</span>, name<span class="op">=</span><span class="st">&#39;dense_1&#39;</span>),</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>        keras.layers.BatchNormalization(),</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>        keras.layers.Activation(<span class="st">&#39;relu&#39;</span>),</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>        keras.layers.Dropout(<span class="fl">0.05</span>, name<span class="op">=</span><span class="st">&#39;dropout_1&#39;</span>),</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>        keras.layers.Dense(<span class="dv">32</span>, name<span class="op">=</span><span class="st">&#39;dense_2&#39;</span>),</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>        keras.layers.BatchNormalization(),</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>        keras.layers.Activation(<span class="st">&#39;relu&#39;</span>),</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>        keras.layers.Dropout(<span class="fl">0.05</span>, name<span class="op">=</span><span class="st">&#39;dropout_2&#39;</span>),</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>        keras.layers.Dense(<span class="dv">16</span>, name<span class="op">=</span><span class="st">&#39;dense_3&#39;</span>),</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>        keras.layers.BatchNormalization(),</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>        keras.layers.Activation(<span class="st">&#39;relu&#39;</span>),</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>        keras.layers.Dropout(<span class="fl">0.05</span>, name<span class="op">=</span><span class="st">&#39;dropout_3&#39;</span>),</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>        keras.layers.Dense(<span class="dv">8</span>, name<span class="op">=</span><span class="st">&#39;dense_4&#39;</span>),</span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>        keras.layers.BatchNormalization(),</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>        keras.layers.Activation(<span class="st">&#39;relu&#39;</span>),</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>        keras.layers.Dropout(<span class="fl">0.05</span>, name<span class="op">=</span><span class="st">&#39;dropout_4&#39;</span>),</span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>        keras.layers.Dense(<span class="dv">1</span>, name<span class="op">=</span><span class="st">&#39;out&#39;</span>)</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>    ])</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="184" id="uabrKkb258gt">
<div class="sourceCode" id="cb59"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compile_model_2(model):</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    model.<span class="bu">compile</span>(</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>      optimizer<span class="op">=</span>keras.optimizers.Adam(</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>            learning_rate<span class="op">=</span><span class="fl">0.001</span>,</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>      loss<span class="op">=</span>keras.losses.MeanAbsolutePercentageError(),</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>      metrics<span class="op">=</span>[<span class="st">&#39;mae&#39;</span>, <span class="st">&#39;mape&#39;</span>, <span class="st">&#39;root_mean_squared_error&#39;</span>]</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="185" id="AlUOkSL-5nzL">
<div class="sourceCode" id="cb60"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># добавим колбэк, который остановит обучение, если ошибка на валидации перестанет снижаться</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>early_stopping <span class="op">=</span> EarlyStopping(</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    monitor<span class="op">=</span><span class="st">&#39;val_loss&#39;</span>,  <span class="co"># отслеживаемая метрика</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    patience<span class="op">=</span><span class="dv">20</span>,         <span class="co"># количество эпох без улучшений</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    restore_best_weights<span class="op">=</span><span class="va">True</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="186"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:782}"
id="NLoX91nE6DI-" data-outputId="53b09eb6-ce3b-42f3-b91d-a5c42fb62209">
<div class="sourceCode" id="cb61"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>model_NN_2 <span class="op">=</span> keras_model_2()</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>model_NN_2 <span class="op">=</span> compile_model_2(model_NN_2) <span class="co"># компиляция нейросети</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>model_NN_2.summary()</span></code></pre></div>
<div class="output display_data">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">Model: "sequential_3"</span>
</pre>

</div>
<div class="output display_data">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> Layer (type)                         </span>┃<span style="font-weight: bold"> Output Shape                </span>┃<span style="font-weight: bold">         Param # </span>┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ dense_1 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                      │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">64</span>)                  │             <span style="color: #00af00; text-decoration-color: #00af00">832</span> │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_4                │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">64</span>)                  │             <span style="color: #00af00; text-decoration-color: #00af00">256</span> │
│ (<span style="color: #0087ff; text-decoration-color: #0087ff">BatchNormalization</span>)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ activation_4 (<span style="color: #0087ff; text-decoration-color: #0087ff">Activation</span>)            │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">64</span>)                  │               <span style="color: #00af00; text-decoration-color: #00af00">0</span> │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dropout</span>)                  │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">64</span>)                  │               <span style="color: #00af00; text-decoration-color: #00af00">0</span> │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_2 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                      │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">32</span>)                  │           <span style="color: #00af00; text-decoration-color: #00af00">2,080</span> │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_5                │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">32</span>)                  │             <span style="color: #00af00; text-decoration-color: #00af00">128</span> │
│ (<span style="color: #0087ff; text-decoration-color: #0087ff">BatchNormalization</span>)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ activation_5 (<span style="color: #0087ff; text-decoration-color: #0087ff">Activation</span>)            │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">32</span>)                  │               <span style="color: #00af00; text-decoration-color: #00af00">0</span> │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_2 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dropout</span>)                  │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">32</span>)                  │               <span style="color: #00af00; text-decoration-color: #00af00">0</span> │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_3 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                      │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">16</span>)                  │             <span style="color: #00af00; text-decoration-color: #00af00">528</span> │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_6                │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">16</span>)                  │              <span style="color: #00af00; text-decoration-color: #00af00">64</span> │
│ (<span style="color: #0087ff; text-decoration-color: #0087ff">BatchNormalization</span>)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ activation_6 (<span style="color: #0087ff; text-decoration-color: #0087ff">Activation</span>)            │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">16</span>)                  │               <span style="color: #00af00; text-decoration-color: #00af00">0</span> │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_3 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dropout</span>)                  │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">16</span>)                  │               <span style="color: #00af00; text-decoration-color: #00af00">0</span> │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_4 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                      │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">8</span>)                   │             <span style="color: #00af00; text-decoration-color: #00af00">136</span> │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_7                │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">8</span>)                   │              <span style="color: #00af00; text-decoration-color: #00af00">32</span> │
│ (<span style="color: #0087ff; text-decoration-color: #0087ff">BatchNormalization</span>)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ activation_7 (<span style="color: #0087ff; text-decoration-color: #0087ff">Activation</span>)            │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">8</span>)                   │               <span style="color: #00af00; text-decoration-color: #00af00">0</span> │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_4 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dropout</span>)                  │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">8</span>)                   │               <span style="color: #00af00; text-decoration-color: #00af00">0</span> │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ out (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                          │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">1</span>)                   │               <span style="color: #00af00; text-decoration-color: #00af00">9</span> │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
</pre>

</div>
<div class="output display_data">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Total params: </span><span style="color: #00af00; text-decoration-color: #00af00">4,065</span> (15.88 KB)
</pre>

</div>
<div class="output display_data">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">3,825</span> (14.94 KB)
</pre>

</div>
<div class="output display_data">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Non-trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">240</span> (960.00 B)
</pre>

</div>
</div>
<div class="cell code" data-execution_count="187"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="y-zQ_Ppn5pGJ" data-outputId="6b06abf0-1b17-4349-a035-53ddda712d1e">
<div class="sourceCode" id="cb62"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>model_NN_hist_2 <span class="op">=</span> model_NN_2.fit(</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>    x3_train, y3_train,</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    epochs<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    validation_split <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    verbose<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    callbacks<span class="op">=</span>[early_stopping]</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Epoch 1/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 3s 29ms/step - loss: 88.1774 - mae: 2.6336 - mape: 88.1774 - root_mean_squared_error: 2.9034 - val_loss: 101.3080 - val_mae: 2.9400 - val_mape: 101.3080 - val_root_mean_squared_error: 3.0803
Epoch 2/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 85.1272 - mae: 2.5797 - mape: 85.1272 - root_mean_squared_error: 2.8376 - val_loss: 97.3045 - val_mae: 2.8419 - val_mape: 97.3045 - val_root_mean_squared_error: 2.9895
Epoch 3/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 11ms/step - loss: 82.6406 - mae: 2.4761 - mape: 82.6406 - root_mean_squared_error: 2.7456 - val_loss: 92.0091 - val_mae: 2.7142 - val_mape: 92.0091 - val_root_mean_squared_error: 2.8732
Epoch 4/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 76.4391 - mae: 2.3288 - mape: 76.4391 - root_mean_squared_error: 2.6428 - val_loss: 85.7786 - val_mae: 2.5604 - val_mape: 85.7786 - val_root_mean_squared_error: 2.7348
Epoch 5/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 72.8013 - mae: 2.2118 - mape: 72.8013 - root_mean_squared_error: 2.5220 - val_loss: 80.6540 - val_mae: 2.4253 - val_mape: 80.6540 - val_root_mean_squared_error: 2.6122
Epoch 6/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 68.4226 - mae: 2.1004 - mape: 68.4226 - root_mean_squared_error: 2.4141 - val_loss: 76.2125 - val_mae: 2.2955 - val_mape: 76.2125 - val_root_mean_squared_error: 2.4895
Epoch 7/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 68.0012 - mae: 2.1230 - mape: 68.0012 - root_mean_squared_error: 2.4435 - val_loss: 72.8693 - val_mae: 2.1947 - val_mape: 72.8693 - val_root_mean_squared_error: 2.3945
Epoch 8/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 63.3918 - mae: 1.9586 - mape: 63.3918 - root_mean_squared_error: 2.2864 - val_loss: 68.9921 - val_mae: 2.0797 - val_mape: 68.9921 - val_root_mean_squared_error: 2.2899
Epoch 9/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 60.8759 - mae: 1.8903 - mape: 60.8759 - root_mean_squared_error: 2.2099 - val_loss: 65.2807 - val_mae: 1.9673 - val_mape: 65.2807 - val_root_mean_squared_error: 2.1897
Epoch 10/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 56.5094 - mae: 1.7879 - mape: 56.5094 - root_mean_squared_error: 2.1386 - val_loss: 61.9958 - val_mae: 1.8660 - val_mape: 61.9958 - val_root_mean_squared_error: 2.0959
Epoch 11/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 53.5538 - mae: 1.6795 - mape: 53.5538 - root_mean_squared_error: 1.9887 - val_loss: 58.8579 - val_mae: 1.7649 - val_mape: 58.8579 - val_root_mean_squared_error: 1.9972
Epoch 12/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 52.7610 - mae: 1.6468 - mape: 52.7610 - root_mean_squared_error: 1.9896 - val_loss: 55.9505 - val_mae: 1.6688 - val_mape: 55.9505 - val_root_mean_squared_error: 1.9039
Epoch 13/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 49.3046 - mae: 1.5228 - mape: 49.3046 - root_mean_squared_error: 1.8566 - val_loss: 53.5609 - val_mae: 1.5894 - val_mape: 53.5609 - val_root_mean_squared_error: 1.8331
Epoch 14/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 46.3477 - mae: 1.4810 - mape: 46.3477 - root_mean_squared_error: 1.8571 - val_loss: 50.7471 - val_mae: 1.4964 - val_mape: 50.7471 - val_root_mean_squared_error: 1.7486
Epoch 15/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 11ms/step - loss: 46.3511 - mae: 1.5121 - mape: 46.3511 - root_mean_squared_error: 1.8840 - val_loss: 48.5594 - val_mae: 1.4252 - val_mape: 48.5594 - val_root_mean_squared_error: 1.6792
Epoch 16/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step - loss: 44.0581 - mae: 1.3986 - mape: 44.0581 - root_mean_squared_error: 1.7304 - val_loss: 47.0553 - val_mae: 1.3719 - val_mape: 47.0553 - val_root_mean_squared_error: 1.6294
Epoch 17/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 42.9683 - mae: 1.3217 - mape: 42.9683 - root_mean_squared_error: 1.6566 - val_loss: 44.5727 - val_mae: 1.2828 - val_mape: 44.5727 - val_root_mean_squared_error: 1.5369
Epoch 18/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 40.7468 - mae: 1.2860 - mape: 40.7468 - root_mean_squared_error: 1.6133 - val_loss: 43.1449 - val_mae: 1.2293 - val_mape: 43.1449 - val_root_mean_squared_error: 1.4854
Epoch 19/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 11ms/step - loss: 38.6380 - mae: 1.1911 - mape: 38.6380 - root_mean_squared_error: 1.4918 - val_loss: 41.4630 - val_mae: 1.1651 - val_mape: 41.4630 - val_root_mean_squared_error: 1.4247
Epoch 20/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 37.7236 - mae: 1.1631 - mape: 37.7236 - root_mean_squared_error: 1.5189 - val_loss: 39.9851 - val_mae: 1.1106 - val_mape: 39.9851 - val_root_mean_squared_error: 1.3767
Epoch 21/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 36.0410 - mae: 1.1402 - mape: 36.0410 - root_mean_squared_error: 1.4499 - val_loss: 39.1776 - val_mae: 1.0797 - val_mape: 39.1776 - val_root_mean_squared_error: 1.3480
Epoch 22/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 35.1636 - mae: 1.0787 - mape: 35.1636 - root_mean_squared_error: 1.3570 - val_loss: 39.2778 - val_mae: 1.0683 - val_mape: 39.2778 - val_root_mean_squared_error: 1.3317
Epoch 23/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 33.3855 - mae: 1.0279 - mape: 33.3855 - root_mean_squared_error: 1.3335 - val_loss: 38.2919 - val_mae: 1.0332 - val_mape: 38.2919 - val_root_mean_squared_error: 1.2950
Epoch 24/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 33.0588 - mae: 1.0379 - mape: 33.0588 - root_mean_squared_error: 1.3239 - val_loss: 37.7014 - val_mae: 1.0121 - val_mape: 37.7014 - val_root_mean_squared_error: 1.2709
Epoch 25/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 33.3764 - mae: 1.0168 - mape: 33.3764 - root_mean_squared_error: 1.3077 - val_loss: 37.1197 - val_mae: 0.9953 - val_mape: 37.1197 - val_root_mean_squared_error: 1.2551
Epoch 26/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 31.1198 - mae: 0.9654 - mape: 31.1198 - root_mean_squared_error: 1.2609 - val_loss: 36.5082 - val_mae: 0.9759 - val_mape: 36.5082 - val_root_mean_squared_error: 1.2372
Epoch 27/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 33.4410 - mae: 0.9961 - mape: 33.4410 - root_mean_squared_error: 1.2347 - val_loss: 35.9189 - val_mae: 0.9481 - val_mape: 35.9189 - val_root_mean_squared_error: 1.2065
Epoch 28/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 31.7753 - mae: 0.9425 - mape: 31.7753 - root_mean_squared_error: 1.2162 - val_loss: 35.7250 - val_mae: 0.9426 - val_mape: 35.7250 - val_root_mean_squared_error: 1.1983
Epoch 29/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 31.4163 - mae: 0.9098 - mape: 31.4163 - root_mean_squared_error: 1.1791 - val_loss: 35.5074 - val_mae: 0.9302 - val_mape: 35.5074 - val_root_mean_squared_error: 1.1859
Epoch 30/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 30.3380 - mae: 0.9241 - mape: 30.3380 - root_mean_squared_error: 1.2162 - val_loss: 35.0743 - val_mae: 0.9107 - val_mape: 35.0743 - val_root_mean_squared_error: 1.1664
Epoch 31/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 31.0265 - mae: 0.9274 - mape: 31.0265 - root_mean_squared_error: 1.1816 - val_loss: 35.1166 - val_mae: 0.9052 - val_mape: 35.1166 - val_root_mean_squared_error: 1.1583
Epoch 32/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 30.5795 - mae: 0.9020 - mape: 30.5795 - root_mean_squared_error: 1.1594 - val_loss: 35.4193 - val_mae: 0.9186 - val_mape: 35.4193 - val_root_mean_squared_error: 1.1754
Epoch 33/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 31.6779 - mae: 0.9362 - mape: 31.6779 - root_mean_squared_error: 1.2053 - val_loss: 35.2969 - val_mae: 0.9165 - val_mape: 35.2969 - val_root_mean_squared_error: 1.1747
Epoch 34/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step - loss: 30.5743 - mae: 0.8858 - mape: 30.5743 - root_mean_squared_error: 1.1416 - val_loss: 34.9503 - val_mae: 0.9046 - val_mape: 34.9503 - val_root_mean_squared_error: 1.1656
Epoch 35/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 29.2796 - mae: 0.8756 - mape: 29.2796 - root_mean_squared_error: 1.1244 - val_loss: 34.8146 - val_mae: 0.9022 - val_mape: 34.8146 - val_root_mean_squared_error: 1.1585
Epoch 36/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 32.7498 - mae: 0.9630 - mape: 32.7498 - root_mean_squared_error: 1.2497 - val_loss: 34.7851 - val_mae: 0.9011 - val_mape: 34.7851 - val_root_mean_squared_error: 1.1563
Epoch 37/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 34.2036 - mae: 0.9369 - mape: 34.2036 - root_mean_squared_error: 1.1902 - val_loss: 34.9569 - val_mae: 0.9039 - val_mape: 34.9569 - val_root_mean_squared_error: 1.1616
Epoch 38/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 29.5941 - mae: 0.8516 - mape: 29.5941 - root_mean_squared_error: 1.1215 - val_loss: 34.5328 - val_mae: 0.8905 - val_mape: 34.5328 - val_root_mean_squared_error: 1.1429
Epoch 39/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 28.2663 - mae: 0.8353 - mape: 28.2663 - root_mean_squared_error: 1.0904 - val_loss: 34.4031 - val_mae: 0.8812 - val_mape: 34.4031 - val_root_mean_squared_error: 1.1274
Epoch 40/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 29.4189 - mae: 0.8682 - mape: 29.4189 - root_mean_squared_error: 1.1131 - val_loss: 34.2038 - val_mae: 0.8790 - val_mape: 34.2038 - val_root_mean_squared_error: 1.1184
Epoch 41/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 28.3999 - mae: 0.8497 - mape: 28.3999 - root_mean_squared_error: 1.0977 - val_loss: 33.9775 - val_mae: 0.8775 - val_mape: 33.9775 - val_root_mean_squared_error: 1.1087
Epoch 42/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 33.2560 - mae: 0.9450 - mape: 33.2560 - root_mean_squared_error: 1.1827 - val_loss: 33.8516 - val_mae: 0.8832 - val_mape: 33.8516 - val_root_mean_squared_error: 1.1139
Epoch 43/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 26.7993 - mae: 0.7905 - mape: 26.7993 - root_mean_squared_error: 1.0548 - val_loss: 33.7730 - val_mae: 0.8827 - val_mape: 33.7730 - val_root_mean_squared_error: 1.1102
Epoch 44/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 30.8106 - mae: 0.8841 - mape: 30.8106 - root_mean_squared_error: 1.1590 - val_loss: 33.5584 - val_mae: 0.8696 - val_mape: 33.5584 - val_root_mean_squared_error: 1.0986
Epoch 45/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 15ms/step - loss: 29.6058 - mae: 0.8406 - mape: 29.6058 - root_mean_squared_error: 1.1102 - val_loss: 33.5060 - val_mae: 0.8573 - val_mape: 33.5060 - val_root_mean_squared_error: 1.0847
Epoch 46/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 13ms/step - loss: 28.2973 - mae: 0.8170 - mape: 28.2973 - root_mean_squared_error: 1.0982 - val_loss: 33.2588 - val_mae: 0.8498 - val_mape: 33.2588 - val_root_mean_squared_error: 1.0817
Epoch 47/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 14ms/step - loss: 32.2736 - mae: 0.8918 - mape: 32.2736 - root_mean_squared_error: 1.1402 - val_loss: 33.1146 - val_mae: 0.8441 - val_mape: 33.1146 - val_root_mean_squared_error: 1.0777
Epoch 48/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 12ms/step - loss: 30.4202 - mae: 0.8614 - mape: 30.4202 - root_mean_squared_error: 1.1206 - val_loss: 33.3478 - val_mae: 0.8518 - val_mape: 33.3478 - val_root_mean_squared_error: 1.0858
Epoch 49/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 12ms/step - loss: 27.6172 - mae: 0.8010 - mape: 27.6172 - root_mean_squared_error: 1.0633 - val_loss: 33.4437 - val_mae: 0.8519 - val_mape: 33.4437 - val_root_mean_squared_error: 1.0821
Epoch 50/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 12ms/step - loss: 28.9648 - mae: 0.8393 - mape: 28.9648 - root_mean_squared_error: 1.0809 - val_loss: 33.3490 - val_mae: 0.8443 - val_mape: 33.3490 - val_root_mean_squared_error: 1.0719
Epoch 51/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 15ms/step - loss: 29.6793 - mae: 0.8841 - mape: 29.6793 - root_mean_squared_error: 1.1641 - val_loss: 33.2222 - val_mae: 0.8350 - val_mape: 33.2222 - val_root_mean_squared_error: 1.0631
Epoch 52/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 27.6915 - mae: 0.7957 - mape: 27.6915 - root_mean_squared_error: 1.0443 - val_loss: 33.0839 - val_mae: 0.8324 - val_mape: 33.0839 - val_root_mean_squared_error: 1.0594
Epoch 53/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 26.4590 - mae: 0.7820 - mape: 26.4590 - root_mean_squared_error: 1.0153 - val_loss: 33.0488 - val_mae: 0.8423 - val_mape: 33.0488 - val_root_mean_squared_error: 1.0696
Epoch 54/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step - loss: 27.9656 - mae: 0.8143 - mape: 27.9656 - root_mean_squared_error: 1.0394 - val_loss: 33.1343 - val_mae: 0.8473 - val_mape: 33.1343 - val_root_mean_squared_error: 1.0758
Epoch 55/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 28.2213 - mae: 0.8224 - mape: 28.2213 - root_mean_squared_error: 1.0697 - val_loss: 33.2355 - val_mae: 0.8535 - val_mape: 33.2355 - val_root_mean_squared_error: 1.0835
Epoch 56/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 11ms/step - loss: 29.3247 - mae: 0.8056 - mape: 29.3247 - root_mean_squared_error: 1.0284 - val_loss: 33.1380 - val_mae: 0.8456 - val_mape: 33.1380 - val_root_mean_squared_error: 1.0753
Epoch 57/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 27.5465 - mae: 0.7853 - mape: 27.5465 - root_mean_squared_error: 1.0220 - val_loss: 33.2205 - val_mae: 0.8454 - val_mape: 33.2205 - val_root_mean_squared_error: 1.0769
Epoch 58/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 29.0212 - mae: 0.8434 - mape: 29.0212 - root_mean_squared_error: 1.0805 - val_loss: 33.0892 - val_mae: 0.8369 - val_mape: 33.0892 - val_root_mean_squared_error: 1.0694
Epoch 59/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - loss: 27.2923 - mae: 0.7790 - mape: 27.2923 - root_mean_squared_error: 0.9927 - val_loss: 33.0064 - val_mae: 0.8300 - val_mape: 33.0064 - val_root_mean_squared_error: 1.0634
Epoch 60/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 27.7437 - mae: 0.8123 - mape: 27.7437 - root_mean_squared_error: 1.0737 - val_loss: 32.9750 - val_mae: 0.8352 - val_mape: 32.9750 - val_root_mean_squared_error: 1.0680
Epoch 61/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 27.4478 - mae: 0.8064 - mape: 27.4478 - root_mean_squared_error: 1.0523 - val_loss: 32.9875 - val_mae: 0.8327 - val_mape: 32.9875 - val_root_mean_squared_error: 1.0605
Epoch 62/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step - loss: 27.9396 - mae: 0.8131 - mape: 27.9396 - root_mean_squared_error: 1.0710 - val_loss: 33.0225 - val_mae: 0.8339 - val_mape: 33.0225 - val_root_mean_squared_error: 1.0597
Epoch 63/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 29.5187 - mae: 0.8217 - mape: 29.5187 - root_mean_squared_error: 1.0378 - val_loss: 33.2124 - val_mae: 0.8420 - val_mape: 33.2124 - val_root_mean_squared_error: 1.0661
Epoch 64/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step - loss: 28.9234 - mae: 0.8181 - mape: 28.9234 - root_mean_squared_error: 1.0705 - val_loss: 33.1259 - val_mae: 0.8400 - val_mape: 33.1259 - val_root_mean_squared_error: 1.0629
Epoch 65/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 27.4513 - mae: 0.7957 - mape: 27.4513 - root_mean_squared_error: 1.0465 - val_loss: 33.0138 - val_mae: 0.8445 - val_mape: 33.0138 - val_root_mean_squared_error: 1.0699
Epoch 66/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 28.3816 - mae: 0.8270 - mape: 28.3816 - root_mean_squared_error: 1.0522 - val_loss: 33.0627 - val_mae: 0.8486 - val_mape: 33.0627 - val_root_mean_squared_error: 1.0761
Epoch 67/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 28.8367 - mae: 0.8210 - mape: 28.8367 - root_mean_squared_error: 1.0562 - val_loss: 33.1063 - val_mae: 0.8512 - val_mape: 33.1063 - val_root_mean_squared_error: 1.0789
Epoch 68/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 30.2124 - mae: 0.8593 - mape: 30.2124 - root_mean_squared_error: 1.1283 - val_loss: 33.0981 - val_mae: 0.8519 - val_mape: 33.0981 - val_root_mean_squared_error: 1.0797
Epoch 69/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 30.2030 - mae: 0.8642 - mape: 30.2030 - root_mean_squared_error: 1.1146 - val_loss: 33.1220 - val_mae: 0.8417 - val_mape: 33.1220 - val_root_mean_squared_error: 1.0646
Epoch 70/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 26.4452 - mae: 0.7750 - mape: 26.4452 - root_mean_squared_error: 1.0322 - val_loss: 33.0844 - val_mae: 0.8282 - val_mape: 33.0844 - val_root_mean_squared_error: 1.0445
Epoch 71/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 26.2439 - mae: 0.7683 - mape: 26.2439 - root_mean_squared_error: 1.0361 - val_loss: 32.9106 - val_mae: 0.8280 - val_mape: 32.9106 - val_root_mean_squared_error: 1.0427
Epoch 72/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 29.2650 - mae: 0.8431 - mape: 29.2650 - root_mean_squared_error: 1.0939 - val_loss: 32.9183 - val_mae: 0.8336 - val_mape: 32.9183 - val_root_mean_squared_error: 1.0466
Epoch 73/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 26.0673 - mae: 0.7504 - mape: 26.0673 - root_mean_squared_error: 0.9910 - val_loss: 33.0930 - val_mae: 0.8485 - val_mape: 33.0930 - val_root_mean_squared_error: 1.0644
Epoch 74/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 16ms/step - loss: 27.3177 - mae: 0.7786 - mape: 27.3177 - root_mean_squared_error: 1.0146 - val_loss: 32.9571 - val_mae: 0.8454 - val_mape: 32.9571 - val_root_mean_squared_error: 1.0625
Epoch 75/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step - loss: 26.5126 - mae: 0.8067 - mape: 26.5126 - root_mean_squared_error: 1.0713 - val_loss: 32.7539 - val_mae: 0.8317 - val_mape: 32.7539 - val_root_mean_squared_error: 1.0464
Epoch 76/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 26.3566 - mae: 0.7873 - mape: 26.3566 - root_mean_squared_error: 1.0491 - val_loss: 32.7062 - val_mae: 0.8289 - val_mape: 32.7062 - val_root_mean_squared_error: 1.0420
Epoch 77/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step - loss: 26.3363 - mae: 0.7520 - mape: 26.3363 - root_mean_squared_error: 1.0035 - val_loss: 32.6479 - val_mae: 0.8282 - val_mape: 32.6479 - val_root_mean_squared_error: 1.0419
Epoch 78/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 29.0963 - mae: 0.8278 - mape: 29.0963 - root_mean_squared_error: 1.0590 - val_loss: 32.7647 - val_mae: 0.8331 - val_mape: 32.7647 - val_root_mean_squared_error: 1.0469
Epoch 79/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 26.8037 - mae: 0.7654 - mape: 26.8037 - root_mean_squared_error: 1.0029 - val_loss: 32.9306 - val_mae: 0.8375 - val_mape: 32.9306 - val_root_mean_squared_error: 1.0498
Epoch 80/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 25.7419 - mae: 0.7559 - mape: 25.7419 - root_mean_squared_error: 1.0043 - val_loss: 32.8307 - val_mae: 0.8327 - val_mape: 32.8307 - val_root_mean_squared_error: 1.0424
Epoch 81/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 26.2780 - mae: 0.8022 - mape: 26.2780 - root_mean_squared_error: 1.0542 - val_loss: 32.9372 - val_mae: 0.8299 - val_mape: 32.9372 - val_root_mean_squared_error: 1.0405
Epoch 82/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 27.0601 - mae: 0.7711 - mape: 27.0601 - root_mean_squared_error: 0.9888 - val_loss: 33.0358 - val_mae: 0.8320 - val_mape: 33.0358 - val_root_mean_squared_error: 1.0445
Epoch 83/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 25.4572 - mae: 0.7027 - mape: 25.4572 - root_mean_squared_error: 0.9312 - val_loss: 32.9890 - val_mae: 0.8364 - val_mape: 32.9890 - val_root_mean_squared_error: 1.0499
Epoch 84/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 11ms/step - loss: 27.0344 - mae: 0.7770 - mape: 27.0344 - root_mean_squared_error: 1.0152 - val_loss: 32.8309 - val_mae: 0.8355 - val_mape: 32.8309 - val_root_mean_squared_error: 1.0521
Epoch 85/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 29.1586 - mae: 0.8120 - mape: 29.1586 - root_mean_squared_error: 1.0518 - val_loss: 32.7775 - val_mae: 0.8297 - val_mape: 32.7775 - val_root_mean_squared_error: 1.0473
Epoch 86/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 24.8780 - mae: 0.7093 - mape: 24.8780 - root_mean_squared_error: 0.9377 - val_loss: 33.0244 - val_mae: 0.8324 - val_mape: 33.0244 - val_root_mean_squared_error: 1.0497
Epoch 87/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 25.7002 - mae: 0.7072 - mape: 25.7002 - root_mean_squared_error: 0.9475 - val_loss: 33.5374 - val_mae: 0.8329 - val_mape: 33.5374 - val_root_mean_squared_error: 1.0441
Epoch 88/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 26.6164 - mae: 0.7763 - mape: 26.6164 - root_mean_squared_error: 1.0185 - val_loss: 33.5078 - val_mae: 0.8331 - val_mape: 33.5078 - val_root_mean_squared_error: 1.0450
Epoch 89/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 27.1373 - mae: 0.7937 - mape: 27.1373 - root_mean_squared_error: 1.0144 - val_loss: 33.4078 - val_mae: 0.8248 - val_mape: 33.4078 - val_root_mean_squared_error: 1.0341
Epoch 90/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step - loss: 27.4686 - mae: 0.8033 - mape: 27.4686 - root_mean_squared_error: 1.0306 - val_loss: 33.2457 - val_mae: 0.8213 - val_mape: 33.2457 - val_root_mean_squared_error: 1.0284
Epoch 91/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 26.1918 - mae: 0.7713 - mape: 26.1918 - root_mean_squared_error: 0.9746 - val_loss: 33.0155 - val_mae: 0.8098 - val_mape: 33.0155 - val_root_mean_squared_error: 1.0083
Epoch 92/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 26.6349 - mae: 0.7624 - mape: 26.6349 - root_mean_squared_error: 0.9587 - val_loss: 32.9718 - val_mae: 0.8144 - val_mape: 32.9718 - val_root_mean_squared_error: 1.0116
Epoch 93/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 25.9234 - mae: 0.7618 - mape: 25.9234 - root_mean_squared_error: 1.0132 - val_loss: 32.9504 - val_mae: 0.8138 - val_mape: 32.9504 - val_root_mean_squared_error: 1.0121
Epoch 94/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 26.2652 - mae: 0.7612 - mape: 26.2652 - root_mean_squared_error: 0.9922 - val_loss: 32.8536 - val_mae: 0.8183 - val_mape: 32.8536 - val_root_mean_squared_error: 1.0204
Epoch 95/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 27.3914 - mae: 0.7727 - mape: 27.3914 - root_mean_squared_error: 1.0166 - val_loss: 32.7570 - val_mae: 0.8194 - val_mape: 32.7570 - val_root_mean_squared_error: 1.0240
Epoch 96/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step - loss: 26.3611 - mae: 0.7364 - mape: 26.3611 - root_mean_squared_error: 0.9455 - val_loss: 32.7008 - val_mae: 0.8161 - val_mape: 32.7008 - val_root_mean_squared_error: 1.0237
Epoch 97/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 25.3882 - mae: 0.7325 - mape: 25.3882 - root_mean_squared_error: 0.9660 - val_loss: 32.5436 - val_mae: 0.8077 - val_mape: 32.5436 - val_root_mean_squared_error: 1.0153
Epoch 98/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 26.4144 - mae: 0.7670 - mape: 26.4144 - root_mean_squared_error: 1.0262 - val_loss: 32.5685 - val_mae: 0.8060 - val_mape: 32.5685 - val_root_mean_squared_error: 1.0121
Epoch 99/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 27.9853 - mae: 0.7747 - mape: 27.9853 - root_mean_squared_error: 0.9916 - val_loss: 32.6159 - val_mae: 0.8122 - val_mape: 32.6159 - val_root_mean_squared_error: 1.0184
Epoch 100/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 25.8694 - mae: 0.7493 - mape: 25.8694 - root_mean_squared_error: 0.9839 - val_loss: 32.7270 - val_mae: 0.8159 - val_mape: 32.7270 - val_root_mean_squared_error: 1.0213
Epoch 101/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 27.2935 - mae: 0.7575 - mape: 27.2935 - root_mean_squared_error: 0.9732 - val_loss: 32.8364 - val_mae: 0.8206 - val_mape: 32.8364 - val_root_mean_squared_error: 1.0255
Epoch 102/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 25.5826 - mae: 0.7582 - mape: 25.5826 - root_mean_squared_error: 1.0231 - val_loss: 32.9176 - val_mae: 0.8151 - val_mape: 32.9176 - val_root_mean_squared_error: 1.0214
Epoch 103/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 25.7900 - mae: 0.7147 - mape: 25.7900 - root_mean_squared_error: 0.9166 - val_loss: 32.8988 - val_mae: 0.8138 - val_mape: 32.8988 - val_root_mean_squared_error: 1.0212
Epoch 104/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 26.6201 - mae: 0.7409 - mape: 26.6201 - root_mean_squared_error: 0.9739 - val_loss: 32.6720 - val_mae: 0.8192 - val_mape: 32.6720 - val_root_mean_squared_error: 1.0304
Epoch 105/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 11ms/step - loss: 25.6123 - mae: 0.7494 - mape: 25.6123 - root_mean_squared_error: 0.9755 - val_loss: 32.5956 - val_mae: 0.8251 - val_mape: 32.5956 - val_root_mean_squared_error: 1.0361
Epoch 106/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 25.6368 - mae: 0.7697 - mape: 25.6368 - root_mean_squared_error: 1.0238 - val_loss: 32.7508 - val_mae: 0.8299 - val_mape: 32.7508 - val_root_mean_squared_error: 1.0382
Epoch 107/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 27.7775 - mae: 0.7579 - mape: 27.7775 - root_mean_squared_error: 1.0122 - val_loss: 32.9041 - val_mae: 0.8485 - val_mape: 32.9041 - val_root_mean_squared_error: 1.0581
Epoch 108/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 13ms/step - loss: 26.3000 - mae: 0.7524 - mape: 26.3000 - root_mean_squared_error: 0.9826 - val_loss: 32.7839 - val_mae: 0.8438 - val_mape: 32.7839 - val_root_mean_squared_error: 1.0517
Epoch 109/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 12ms/step - loss: 27.7415 - mae: 0.7849 - mape: 27.7415 - root_mean_squared_error: 1.0254 - val_loss: 32.6454 - val_mae: 0.8405 - val_mape: 32.6454 - val_root_mean_squared_error: 1.0459
Epoch 110/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 17ms/step - loss: 25.3992 - mae: 0.7329 - mape: 25.3992 - root_mean_squared_error: 0.9556 - val_loss: 32.5486 - val_mae: 0.8321 - val_mape: 32.5486 - val_root_mean_squared_error: 1.0402
Epoch 111/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 12ms/step - loss: 26.2313 - mae: 0.7658 - mape: 26.2313 - root_mean_squared_error: 1.0197 - val_loss: 32.4753 - val_mae: 0.8265 - val_mape: 32.4753 - val_root_mean_squared_error: 1.0322
Epoch 112/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 28.1555 - mae: 0.8067 - mape: 28.1555 - root_mean_squared_error: 1.0266 - val_loss: 32.7526 - val_mae: 0.8311 - val_mape: 32.7526 - val_root_mean_squared_error: 1.0346
Epoch 113/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 11ms/step - loss: 25.9762 - mae: 0.7465 - mape: 25.9762 - root_mean_squared_error: 0.9719 - val_loss: 33.0756 - val_mae: 0.8450 - val_mape: 33.0756 - val_root_mean_squared_error: 1.0483
Epoch 114/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 14ms/step - loss: 26.6767 - mae: 0.7543 - mape: 26.6767 - root_mean_squared_error: 0.9760 - val_loss: 33.0809 - val_mae: 0.8398 - val_mape: 33.0809 - val_root_mean_squared_error: 1.0406
Epoch 115/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 24.9144 - mae: 0.7471 - mape: 24.9144 - root_mean_squared_error: 0.9952 - val_loss: 33.1360 - val_mae: 0.8430 - val_mape: 33.1360 - val_root_mean_squared_error: 1.0470
Epoch 116/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step - loss: 26.9405 - mae: 0.8014 - mape: 26.9405 - root_mean_squared_error: 1.0219 - val_loss: 33.1961 - val_mae: 0.8380 - val_mape: 33.1961 - val_root_mean_squared_error: 1.0406
Epoch 117/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 27.1640 - mae: 0.7708 - mape: 27.1640 - root_mean_squared_error: 0.9830 - val_loss: 33.1043 - val_mae: 0.8291 - val_mape: 33.1043 - val_root_mean_squared_error: 1.0292
Epoch 118/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 24.7971 - mae: 0.7180 - mape: 24.7971 - root_mean_squared_error: 0.9372 - val_loss: 33.0583 - val_mae: 0.8298 - val_mape: 33.0583 - val_root_mean_squared_error: 1.0303
Epoch 119/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 25.9042 - mae: 0.7329 - mape: 25.9042 - root_mean_squared_error: 0.9519 - val_loss: 32.9788 - val_mae: 0.8375 - val_mape: 32.9788 - val_root_mean_squared_error: 1.0377
Epoch 120/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 25.6958 - mae: 0.7331 - mape: 25.6958 - root_mean_squared_error: 0.9420 - val_loss: 32.8444 - val_mae: 0.8351 - val_mape: 32.8444 - val_root_mean_squared_error: 1.0351
Epoch 121/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 24.9440 - mae: 0.6913 - mape: 24.9440 - root_mean_squared_error: 0.8880 - val_loss: 32.7418 - val_mae: 0.8343 - val_mape: 32.7418 - val_root_mean_squared_error: 1.0336
Epoch 122/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 24.8853 - mae: 0.7460 - mape: 24.8853 - root_mean_squared_error: 0.9656 - val_loss: 32.7088 - val_mae: 0.8245 - val_mape: 32.7088 - val_root_mean_squared_error: 1.0224
Epoch 123/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 23.9087 - mae: 0.6987 - mape: 23.9087 - root_mean_squared_error: 0.9468 - val_loss: 32.7137 - val_mae: 0.8229 - val_mape: 32.7137 - val_root_mean_squared_error: 1.0212
Epoch 124/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 25.3294 - mae: 0.7623 - mape: 25.3294 - root_mean_squared_error: 0.9948 - val_loss: 32.7839 - val_mae: 0.8194 - val_mape: 32.7839 - val_root_mean_squared_error: 1.0128
Epoch 125/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - loss: 24.9491 - mae: 0.7008 - mape: 24.9491 - root_mean_squared_error: 0.9202 - val_loss: 32.7672 - val_mae: 0.8153 - val_mape: 32.7672 - val_root_mean_squared_error: 1.0075
Epoch 126/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 12ms/step - loss: 26.8374 - mae: 0.7588 - mape: 26.8374 - root_mean_squared_error: 0.9739 - val_loss: 32.7533 - val_mae: 0.8174 - val_mape: 32.7533 - val_root_mean_squared_error: 1.0119
Epoch 127/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - loss: 25.8426 - mae: 0.7628 - mape: 25.8426 - root_mean_squared_error: 0.9973 - val_loss: 32.7835 - val_mae: 0.8144 - val_mape: 32.7835 - val_root_mean_squared_error: 1.0111
Epoch 128/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step - loss: 26.6987 - mae: 0.7399 - mape: 26.6987 - root_mean_squared_error: 0.9463 - val_loss: 32.8729 - val_mae: 0.8208 - val_mape: 32.8729 - val_root_mean_squared_error: 1.0180
Epoch 129/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 11ms/step - loss: 24.1812 - mae: 0.7166 - mape: 24.1812 - root_mean_squared_error: 0.9603 - val_loss: 32.7913 - val_mae: 0.8280 - val_mape: 32.7913 - val_root_mean_squared_error: 1.0296
Epoch 130/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 25.1603 - mae: 0.7435 - mape: 25.1603 - root_mean_squared_error: 0.9659 - val_loss: 32.9401 - val_mae: 0.8302 - val_mape: 32.9401 - val_root_mean_squared_error: 1.0312
Epoch 131/1000
15/15 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - loss: 24.0846 - mae: 0.6957 - mape: 24.0846 - root_mean_squared_error: 0.9051 - val_loss: 32.8540 - val_mae: 0.8249 - val_mape: 32.8540 - val_root_mean_squared_error: 1.0242
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="188"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:487}"
id="3kyDVzRm7tqA" data-outputId="24d91b7c-42aa-4be4-86b2-85eb6efa90b3">
<div class="sourceCode" id="cb64"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>plot_nn_loss(model_NN_hist_2)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_823183e1f35445208756c956c399aa02/538feffd54f062cbe6d129cea497771e1a16454d.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="189"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:559}"
id="J0Aw6fsM8D-A" data-outputId="56f9b62d-1b40-4907-9f5c-7317b03acbbd">
<div class="sourceCode" id="cb65"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>y3_NN_pred_2 <span class="op">=</span> model_NN_2.predict(x3_test)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>plt.scatter(y3_test, y3_NN_pred_2, alpha<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">&quot;blue&quot;</span>, label<span class="op">=</span><span class="st">&quot;Предсказания&quot;</span>)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="bu">min</span>(y3_test), <span class="bu">max</span>(y3_test)], [<span class="bu">min</span>(y3_test), <span class="bu">max</span>(y3_test)], color<span class="op">=</span><span class="st">&quot;red&quot;</span>, linestyle<span class="op">=</span><span class="st">&quot;--&quot;</span>, label<span class="op">=</span><span class="st">&quot;Идеальная линия&quot;</span>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Истинные значения&quot;</span>)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Предсказанные значения&quot;</span>)</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>9/9 ━━━━━━━━━━━━━━━━━━━━ 0s 12ms/step
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_823183e1f35445208756c956c399aa02/75b7bb64b61dce6b1afe25f735a5e73c0af193cc.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="190"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:143}"
id="tmYqI-gDv5Uf" data-outputId="6869b520-dd12-425e-c20d-139e4d63b7b9">
<div class="sourceCode" id="cb67"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>models_diff <span class="op">=</span> calculate_metrics(<span class="st">&#39;Dummy Regressor&#39;</span>, y3_test, y3_dummy)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>models_diff <span class="op">=</span> pd.concat([</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    models_diff,</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    calculate_metrics(<span class="st">&#39;Обученная нейросеть&#39;</span>, y3_test, y3_NN_pred),</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    calculate_metrics(<span class="st">&#39;Нейросеть модифицированная&#39;</span>, y3_test, y3_NN_pred_2)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>],</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    ignore_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>styled_models_diff <span class="op">=</span> style_model_results(models_diff)</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>styled_models_diff</span></code></pre></div>
<div class="output execute_result" data-execution_count="190">
<style type="text/css">
#T_13c4b_row0_col0, #T_13c4b_row0_col1, #T_13c4b_row0_col2, #T_13c4b_row0_col3 {
  background-color: green;
}
#T_13c4b_row1_col0, #T_13c4b_row1_col1, #T_13c4b_row1_col2, #T_13c4b_row1_col3 {
  background-color: blue;
}
</style>
<table id="T_13c4b" class="dataframe">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_13c4b_level0_col0" class="col_heading level0 col0" >R2</th>
      <th id="T_13c4b_level0_col1" class="col_heading level0 col1" >RMSE</th>
      <th id="T_13c4b_level0_col2" class="col_heading level0 col2" >MAE</th>
      <th id="T_13c4b_level0_col3" class="col_heading level0 col3" >MAPE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_13c4b_level0_row0" class="row_heading level0 row0" >Dummy Regressor</th>
      <td id="T_13c4b_row0_col0" class="data row0 col0" >-0.000080</td>
      <td id="T_13c4b_row0_col1" class="data row0 col1" >0.874368</td>
      <td id="T_13c4b_row0_col2" class="data row0 col2" >0.710610</td>
      <td id="T_13c4b_row0_col3" class="data row0 col3" >0.303820</td>
    </tr>
    <tr>
      <th id="T_13c4b_level0_row1" class="row_heading level0 row1" >Обученная нейросеть</th>
      <td id="T_13c4b_row1_col0" class="data row1 col0" >-0.976090</td>
      <td id="T_13c4b_row1_col1" class="data row1 col1" >1.229081</td>
      <td id="T_13c4b_row1_col2" class="data row1 col2" >0.977477</td>
      <td id="T_13c4b_row1_col3" class="data row1 col3" >0.393238</td>
    </tr>
    <tr>
      <th id="T_13c4b_level0_row2" class="row_heading level0 row2" >Нейросеть модифицированная</th>
      <td id="T_13c4b_row2_col0" class="data row2 col0" >-0.438251</td>
      <td id="T_13c4b_row2_col1" class="data row2 col1" >1.048563</td>
      <td id="T_13c4b_row2_col2" class="data row2 col2" >0.867306</td>
      <td id="T_13c4b_row2_col3" class="data row2 col3" >0.320932</td>
    </tr>
  </tbody>
</table>

</div>
</div>
<div class="cell markdown" id="tahK6AtS2GZm">
<p>Нейронные сети показали себя хуже базовой модели. Обычная нейросеть
продемонстрировала высокий уровень ошибки и слабую обобщающую
способность. Модифицированная нейросеть несколько снизила ошибки, но по
коэффициенту детерминации также показала неудовлетворительный результат.
В целом, ни одна из моделей не смогла превзойти базовую по коэффициенту
детерминации, что говорит о необходимости доработки архитектуры или
предобработки данных.</p>
</div>
<div class="cell code" data-execution_count="191"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:272}"
id="48ZIU73eIccP" data-outputId="8a7de345-d017-483c-cca0-1bc2b1c627ef">
<div class="sourceCode" id="cb68"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>all_best_results <span class="op">=</span> pd.DataFrame()</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>all_best_results_1 <span class="op">=</span> pd.DataFrame()</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>y1_predicted_train <span class="op">=</span> best_model_1.predict(x1_train)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>all_best_results_1 <span class="op">=</span> pd.concat([all_best_results_1, calculate_metrics(<span class="st">&#39;Train по параметру Модуль упругости при растяжении&#39;</span>, y1_train, y1_predicted_train)], ignore_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>y1_predicted_test <span class="op">=</span> best_model_1.predict(x1_test)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>all_best_results_1 <span class="op">=</span> pd.concat([all_best_results_1, calculate_metrics(<span class="st">&#39;Test по параметру Модуль упругости при растяжении&#39;</span>, y1_test, y1_predicted_test)], ignore_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>all_best_results_1 <span class="op">=</span> all_best_results_1.<span class="bu">round</span>(<span class="dv">3</span>)</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>all_best_results_2 <span class="op">=</span> pd.DataFrame()</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>y2_predicted_train <span class="op">=</span> best_model_2.predict(x2_train)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>all_best_results_2 <span class="op">=</span> pd.concat([all_best_results_2, calculate_metrics(<span class="st">&#39;Train по параметру Прочность при растяжении&#39;</span>, y2_train, y2_predicted_train)], ignore_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>y2_predicted_test <span class="op">=</span> best_model_2.predict(x2_test)</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>all_best_results_2 <span class="op">=</span> pd.concat([all_best_results_2, calculate_metrics(<span class="st">&#39;Test по параметру Прочность при растяжении&#39;</span>, y2_test, y2_predicted_test)], ignore_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>all_best_results_3 <span class="op">=</span> pd.DataFrame()</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>y3_predicted_train <span class="op">=</span> model_NN_2.predict(x3_train)</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>all_best_results_3 <span class="op">=</span> pd.concat([all_best_results_3, calculate_metrics(<span class="st">&#39;Train по параметру Соотношение матрица-наполнитель&#39;</span>, y3_train, y3_predicted_train)], ignore_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>y3_predicted_test <span class="op">=</span> model_NN_2.predict(x3_test)</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>all_best_results_3 <span class="op">=</span> pd.concat([all_best_results_3, calculate_metrics(<span class="st">&#39;Test по параметру Соотношение матрица-наполнитель&#39;</span>, y3_test, y3_predicted_test)], ignore_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>all_best_results <span class="op">=</span> pd.concat([all_best_results_1, all_best_results_2, all_best_results_3], ignore_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>all_best_results</span></code></pre></div>
<div class="output stream stdout">
<pre><code>21/21 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step 
9/9 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step 
</code></pre>
</div>
<div class="output execute_result" data-execution_count="191">

  <div id="df-8985745c-2493-401f-8206-8b672d1eb6a0" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>R2</th>
      <th>RMSE</th>
      <th>MAE</th>
      <th>MAPE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Train по параметру Модуль упругости при растяжении</th>
      <td>0.0</td>
      <td>2.964995</td>
      <td>2.388992</td>
      <td>0.032669</td>
    </tr>
    <tr>
      <th>Test по параметру Модуль упругости при растяжении</th>
      <td>-0.008879</td>
      <td>3.162017</td>
      <td>2.580193</td>
      <td>0.035032</td>
    </tr>
    <tr>
      <th>Train по параметру Прочность при растяжении</th>
      <td>0.039483</td>
      <td>440.289051</td>
      <td>351.024149</td>
      <td>0.151906</td>
    </tr>
    <tr>
      <th>Test по параметру Прочность при растяжении</th>
      <td>-0.001992</td>
      <td>463.112002</td>
      <td>369.709111</td>
      <td>0.162112</td>
    </tr>
    <tr>
      <th>Train по параметру Соотношение матрица-наполнитель</th>
      <td>-0.001998</td>
      <td>0.904603</td>
      <td>0.689468</td>
      <td>0.243023</td>
    </tr>
    <tr>
      <th>Test по параметру Соотношение матрица-наполнитель</th>
      <td>-0.438251</td>
      <td>1.048563</td>
      <td>0.867306</td>
      <td>0.320932</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-8985745c-2493-401f-8206-8b672d1eb6a0')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-8985745c-2493-401f-8206-8b672d1eb6a0 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-8985745c-2493-401f-8206-8b672d1eb6a0');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-2305cfa8-fadb-4cae-a7c0-5468d78b82e8">
  <button class="colab-df-quickchart" onclick="quickchart('df-2305cfa8-fadb-4cae-a7c0-5468d78b82e8')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-2305cfa8-fadb-4cae-a7c0-5468d78b82e8 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="Lep5Llz48bpw">
<p>Линейная модель Lasso показала отрицательное значение R² на тестовом
датасете, что говорит о том, что модель работает хуже, чем простое
среднее значение.</p>
<p>Хотя бы градиентный бустинг показал положительный R² на тренировочном
датасете, то есть модель смогла уловить часть зависимости. На тестовом
датасете из-за возможного переобучения коэф детерминации чуть ниже нуля.
Значения RMSE, MAE и MAPE остаются аналогично высокими.</p>
<p>Нейросеть показала наихудший результат среди моделей: отрицательные
значения R² как на тренировочном, так и на тестовом датасете.
Настроенная мною нейросеть не смогла уловить зависимость в данных и,
возможно, просто запомнила шум. Ошибки также остаются высокими.</p>
</div>
<div class="cell code" data-execution_count="192" id="_HrdOvNeBd1i">
<div class="sourceCode" id="cb70"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># дополнительно найду максимальные значения ошибок, чтобы оценить насколько релевантны лучшие модели</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_max_error(model_name, true_values, predicted_values):</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> pd.DataFrame(index<span class="op">=</span>[model_name])</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    results.loc[model_name, <span class="st">&#39;max_error&#39;</span>] <span class="op">=</span> metrics.max_error(true_values, predicted_values)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="193"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:161}"
id="bsRzXJvmDn-H" data-outputId="546cf5c0-1026-46b0-bcf3-aed08584f7e7">
<div class="sourceCode" id="cb71"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>all_max_errors <span class="op">=</span> pd.DataFrame()</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>max_error_1 <span class="op">=</span> pd.DataFrame()</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>y1_predicted_test_error <span class="op">=</span> best_model_1.predict(x1_test)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>max_error_1 <span class="op">=</span> pd.concat([max_error_1, calculate_max_error(<span class="st">&#39;Test по параметру Модуль упругости при растяжении&#39;</span>, y1_test, y1_predicted_test_error)], ignore_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>max_error_2 <span class="op">=</span> pd.DataFrame()</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>y2_predicted_test_error <span class="op">=</span> best_model_2.predict(x2_test)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>max_error_2 <span class="op">=</span> pd.concat([max_error_2, calculate_max_error(<span class="st">&#39;Test по параметру Прочность при растяжении&#39;</span>, y2_test, y2_predicted_test_error)], ignore_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>max_error_3 <span class="op">=</span> pd.DataFrame()</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>y3_predicted_test <span class="op">=</span> model_NN_2.predict(x3_test)</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>max_error_3 <span class="op">=</span> pd.concat([max_error_3, calculate_max_error(<span class="st">&#39;Test по параметру Соотношение матрица-наполнитель&#39;</span>, y3_test, y3_predicted_test)], ignore_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>all_max_errors <span class="op">=</span> pd.concat([max_error_1, max_error_2, max_error_3], ignore_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>all_max_errors</span></code></pre></div>
<div class="output stream stdout">
<pre><code>9/9 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step 
</code></pre>
</div>
<div class="output execute_result" data-execution_count="193">

  <div id="df-dc7f9d73-30e0-41e2-baa4-9fb01ebd9bb2" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>max_error</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test по параметру Модуль упругости при растяжении</th>
      <td>7.960885</td>
    </tr>
    <tr>
      <th>Test по параметру Прочность при растяжении</th>
      <td>1231.471332</td>
    </tr>
    <tr>
      <th>Test по параметру Соотношение матрица-наполнитель</th>
      <td>2.907571</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-dc7f9d73-30e0-41e2-baa4-9fb01ebd9bb2')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-dc7f9d73-30e0-41e2-baa4-9fb01ebd9bb2 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-dc7f9d73-30e0-41e2-baa4-9fb01ebd9bb2');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-f1cf99d3-6cd5-4a6e-8a8b-edf8fba55c94">
  <button class="colab-df-quickchart" onclick="quickchart('df-f1cf99d3-6cd5-4a6e-8a8b-edf8fba55c94')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-f1cf99d3-6cd5-4a6e-8a8b-edf8fba55c94 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<section
id="приложение-с-графическим-интерфейсом-выдающее-прогноз-на-основании-созданных-моделей"
class="cell markdown" id="G-_NOgx6MaB1">
<h1>Приложение с графическим интерфейсом, выдающее прогноз на основании
созданных моделей</h1>
</section>
<div class="cell markdown" id="-jby3eT8mYiM">
<p>В качестве модели для прогнозирования буду использовать нейронную
сеть на tensorflow.</p>
</div>
<div class="cell code" data-execution_count="194" id="FwRbqHkX9oXB">
<div class="sourceCode" id="cb73"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> flask <span class="im">import</span> Flask, request, render_template</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow <span class="im">import</span> keras</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="195" id="kOgYsgiwJsSt">
<div class="sourceCode" id="cb74"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cоздаём папку models</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>os.makedirs(<span class="st">&quot;models&quot;</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="199" id="dB8U2C3Sqn0s">
<div class="sourceCode" id="cb75"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>model_path <span class="op">=</span> <span class="st">&quot;model_NN_2.keras&quot;</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>model_NN_2.save(model_path)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="197" id="5nUygW_tRhBq">
<div class="sourceCode" id="cb76"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>x3_train_df <span class="op">=</span> pd.DataFrame(x3_train, columns<span class="op">=</span>[<span class="st">&#39;var2&#39;</span>, <span class="st">&#39;var3&#39;</span>, <span class="st">&#39;var4&#39;</span>, <span class="st">&#39;var5&#39;</span>, <span class="st">&#39;var6&#39;</span>, <span class="st">&#39;var7&#39;</span>, <span class="st">&#39;var8&#39;</span>, <span class="st">&#39;var9&#39;</span>, <span class="st">&#39;var10&#39;</span>, <span class="st">&#39;var11&#39;</span>, <span class="st">&#39;var12&#39;</span>, <span class="st">&#39;var13&#39;</span>])</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Создание и обучение препроцессора</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>preprocessor <span class="op">=</span> ColumnTransformer([</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&#39;scaler&#39;</span>, StandardScaler(), [<span class="st">&#39;var2&#39;</span>, <span class="st">&#39;var3&#39;</span>, <span class="st">&#39;var4&#39;</span>, <span class="st">&#39;var5&#39;</span>, <span class="st">&#39;var6&#39;</span>, <span class="st">&#39;var7&#39;</span>, <span class="st">&#39;var8&#39;</span>, <span class="st">&#39;var9&#39;</span>, <span class="st">&#39;var10&#39;</span>, <span class="st">&#39;var11&#39;</span>, <span class="st">&#39;var12&#39;</span>, <span class="st">&#39;var13&#39;</span>])</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Обучение препроцессора на тренировочных данных</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>preprocessor.fit(x3_train_df)</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Сохранение препроцессора</span></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;models/Preprocessor_NN_scaler.pkl&#39;</span>, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>    pickle.dump(preprocessor, f)</span></code></pre></div>
</div>
</body>
</html>
